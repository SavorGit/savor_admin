<include file="Public/script"/>
<div class="pageContent autoflow statistic">
    <div class="indexContent">

        <div class="portlet-tab">
            <div class="btn-group">
                <a href="{$host_url}/smallapp/deviceoverview/index?city=0" target="navTab" rel="deviceoverview/index" title="设备概况"><button type="button"  class="btn btn-sm active">全部城市</button></a>
                <a href="{$host_url}/smallapp/deviceoverview/index?city=1" target="navTab" rel="deviceoverview/index" title="设备概况"><button type="button"  class="btn btn-sm ">北京</button></a>
                <a href="{$host_url}/smallapp/deviceoverview/index?city=1" target="navTab" rel="deviceoverview/index" title="设备概况"><button type="button"  class="btn btn-sm ">上海</button></a>
                <a href="{$host_url}/smallapp/deviceoverview/index?city=1" target="navTab" rel="deviceoverview/index" title="设备概况"><button type="button"  class="btn btn-sm ">广州</button></a>
                <a href="{$host_url}/smallapp/deviceoverview/index?city=1" target="navTab" rel="deviceoverview/index" title="设备概况"><button type="button"  class="btn btn-sm ">深圳</button></a>

            </div>
        </div>

        <div class="portlet light bg-inverse portlet-table">
            <div class="portlet-title">
                <div class="caption">
                    版位开机趋势（近30天）<span class="badge1" data-container="body" data-toggle="popover" data-placement="bottom" data-content="屏幕总数：所有正常（非冻结、非报损、非删除）网络版位的总数，开机总数：每天午饭（11:30-13:30）开机与晚饭（18:00-21:00）开机的总和，屏幕在线率：屏幕在线率=在线屏/网络屏总数=（午饭在线屏+晚饭在线屏）/（屏幕总数*2）">?</span>
                </div>
            </div>
            <div class="portlet-body row">
                <div id="echart_mac" class="chart"></div>
            </div>
        </div>
        <div class="portlet light bg-inverse portlet-table">
            <div class="portlet-title">
                <div class="caption">
                    屏幕分时段在线情况（近30天）<span class="badge1" data-container="body" data-toggle="popover" data-placement="bottom" data-content="屏幕数：近三十天的屏幕总数平均值，在线版位数：在每个小时三十天内平均有多少个版位在线">?</span>
                </div>
            </div>
            <div class="portlet-body row">
                <div id="echart_screen" class="chart"></div>
            </div>
        </div>

        <div class="portlet-row row portlet light bg-inverse">
            <div class="col-md-6">
                <div class="portlet-title">
                    <div class="caption">
                        平均开机时长（近30天）
                    </div>
                </div>
                <div class="portlet-body row">
                    <div id="echart_avg_screenon" class="chart"></div>
                </div>
            </div>
            <div class="col-md-6">
                <div class="portlet-title">
                    <div class="caption">
                        <span class="pull-left">网络情况（近30天）</span><span class="pull-right"><a target="ajaxTodo" calback="navTabAjaxDone" href="{$host_url}/smallapp/deviceoverview/networkedit?id={$dinfo.id}"  class="btn btn-icon"><i class="fa fa-cog"></i></a>
                    </span>
                    </div>
                </div>
                <div class="portlet-body row">
                    <div id="echart_network" class="chart"></div>
                </div>
            </div>
        </div>

        <div class="portlet-row row portlet light bg-inverse">
            <div class="col-md-6">
                <div class="portlet-title">
                    <div class="caption">
                        机顶盒APK版本分布（昨天）
                    </div>
                </div>
                <div class="portlet-body row">
                    <div id="echart_apk" class="chart"></div>
                </div>
            </div>
            <div class="col-md-6">
                <div class="portlet-title">
                    <div class="caption">
                        设备类型（天）
                    </div>
                </div>
                <div class="portlet-body row">
                    <div id="echart_devicetype" class="chart"></div>
                </div>
            </div>
        </div>


    </div>
</div>
<script>
    var dom = document.getElementById("echart_mac");
    var myChart = echarts.init(dom);
    option_mac = {
        tooltip : {
            trigger: 'axis'
        },
        toolbox: {
            show : true,
            feature : {
                restore : {show: true},
                saveAsImage : {show: true}
            }
        },
        calculable : true,
        legend: {
            data:['午饭开机','晚饭开机','屏幕总数','开机率']
        },
        xAxis : [
            {
                type : 'category',
                data : ['20190501','20190502','20190503','20190504','20190505','20190506','20190507','20190508','20190509','20190510','20190511','20190512']
            }
        ],
        yAxis : [
            {
                type : 'value',
                name : '版位开机数',
                axisLabel : {
                    formatter: '{value}'
                }
            },
            {
                type : 'value',
                name : '开机率',
                axisLabel : {
                    formatter: '{value}'
                }
            }
        ],
        series : [

            {
                name:'午饭开机',
                type:'bar',
                data:[2.0, 4.9, 7.0, 23.2, 25.6, 76.7, 135.6, 162.2, 32.6, 20.0, 6.4, 3.3]
            },
            {
                name:'晚饭开机',
                type:'bar',
                data:[2.6, 5.9, 9.0, 26.4, 28.7, 70.7, 175.6, 182.2, 48.7, 18.8, 6.0, 2.3]
            },
            {
                name:'屏幕总数',
                type:'bar',
                data:[2.6, 5.9, 9.0, 26.4, 28.7, 70.7, 175.6, 182.2, 48.7, 18.8, 6.0, 2.3]
            },
            {
                name:'开机率',
                type:'line',
                yAxisIndex: 1,
                data:[2.0, 2.2, 3.3, 4.5, 6.3, 10.2, 20.3, 23.4, 23.0, 16.5, 12.0, 6.2]
            }
        ]
    };
    myChart.setOption(option_mac, true);

    var dom = document.getElementById("echart_screen");
    var myChart = echarts.init(dom);
    option_screen = {
        tooltip : {
            trigger: 'axis'
        },
        toolbox: {
            show : true,
            feature : {
                restore : {show: true},
                saveAsImage : {show: true}
            }
        },
        calculable : true,
        legend: {
            data:['版位在线数']
        },
        xAxis : [
            {
                type : 'category',
                data : ['1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24']
            }
        ],
        yAxis : [
            {
                type : 'value',
                name : '版位在线数',
                axisLabel : {
                    formatter: '{value}'
                }
            }
        ],
        series : [

            {
                name:'版位在线数',
                type:'bar',
                data:[150,135.6,162.2,120,110,121,123,900,210,99,173,11,150,135.6,162.2,120,110,121,123,900,210,99,173,788]
            }
        ]
    };
    myChart.setOption(option_screen, true);

    var dom = document.getElementById("echart_avg_screenon");
    var myChart = echarts.init(dom);
    option_avg_screenon = {
        tooltip : {
            trigger: 'item',
            formatter: "{a} <br/>{b} : {c} ({d}%)"
        },
        legend: {
            orient : 'vertical',
            x : 'left',
            data:['0h','0-1h','1-2h','2-3h','3-4h','4-5h','5-6h','6h以上']
        },
        toolbox: {
            show : true,
            feature : {
                magicType : {
                    show: true,
                    type: ['pie', 'funnel'],
                    option: {
                        funnel: {
                            x: '25%',
                            width: '50%',
                            funnelAlign: 'left',
                            max: 1548
                        }
                    }
                },
                restore : {show: true},
                saveAsImage : {show: true}
            }
        },
        calculable : true,
        series : [
            {
                name:'版位总数：2310',
                type:'pie',
                radius : '55%',
                center: ['50%', '60%'],
                data:[
                    {value:335, name:'0h'},
                    {value:350, name:'0-1h'},
                    {value:20, name:'1-2h'},
                    {value:14, name:'2-3h'},
                    {value:120, name:'3-4h'},
                    {value:74, name:'4-5h'},
                    {value:50, name:'5-6h'},
                    {value:10, name:'6h以上'},
                ]
            }
        ]
    };
    myChart.setOption(option_avg_screenon, true);

    var dom = document.getElementById("echart_network");
    var myChart = echarts.init(dom);
    option_network = {
        tooltip : {
            trigger: 'item',
            formatter: "{a} <br/>{b} : {c} ({d}%)"
        },
        legend: {
            orient : 'vertical',
            x : 'left',
            data:['0k/s','1-50k/s','51-100k/s','101-200k/s','201-500k/s','501k/s以上']
        },
        toolbox: {
            show : true,
            feature : {
                magicType : {
                    show: true,
                    type: ['pie', 'funnel'],
                    option: {
                        funnel: {
                            x: '25%',
                            width: '50%',
                            funnelAlign: 'left',
                            max: 1548
                        }
                    }
                },
                restore : {show: true},
                saveAsImage : {show: true}
            }
        },
        calculable : true,
        series : [
            {
                name:'版位总数：2310',
                type:'pie',

                radius : '55%',
                center: ['50%', '60%'],
                itemStyle: {
                    normal: {
                        label: {        //此处为指示线文字
                            show: true,
                            textStyle: {
                                fontWeight: 200,
                                fontSize: 10    //文字的字体大小
                            },
                            formatter:'{d}%'
                        },
                        labelLine: {//指示线状态
                            show: true,
                            smooth: 0.2,
                            length: 10,
                            length2: 20
                        }
                    }
                },
                data:[
                    {value:335, name:'0k/s',tooltip : {formatter: "{a} <br/>{b} : {c} ({d}%)<br/>北京122，上海123"}},
                    {value:350, name:'1-50k/s'},
                    {value:20, name:'51-100k/s'},
                    {value:14, name:'101-200k/s'},
                    {value:120, name:'201-500k/s'},
                    {value:74, name:'501k/s以上'}
                ]
            }
        ]
    };
    myChart.setOption(option_network, true);

    var dom = document.getElementById("echart_apk");
    var myChart = echarts.init(dom);
    option_apk = {
        tooltip : {
            trigger: 'item',
            formatter: "{a} <br/>{b} : {c} ({d}%)"
        },
        legend: {
            orient : 'vertical',
            x : 'left',
            data:['1.3.2.3','1.3.2.2','1.3.2.1','1.3.2.0',]
        },
        toolbox: {
            show : true,
            feature : {
                magicType : {
                    show: true,
                    type: ['pie', 'funnel'],
                    option: {
                        funnel: {
                            x: '25%',
                            width: '50%',
                            funnelAlign: 'left',
                            max: 1548
                        }
                    }
                },
                restore : {show: true},
                saveAsImage : {show: true}
            }
        },
        calculable : true,
        series : [
            {
                name:'版位总数：2310',
                type:'pie',
                radius : '55%',
                center: ['50%', '60%'],
                data:[
                    {value:335, name:'1.3.2.3'},
                    {value:335, name:'1.3.2.2'},
                    {value:335, name:'1.3.2.1'},
                    {value:335, name:'1.3.2.0'},
                ]
            }
        ]
    };
    myChart.setOption(option_apk, true);

    var dom = document.getElementById("echart_devicetype");
    var myChart = echarts.init(dom);
    option_devicetype = {
        tooltip : {
            trigger: 'item',
            formatter: "{a} <br/>{b} : {c} ({d}%)"
        },
        legend: {
            orient : 'vertical',
            x : 'left',
            data:['一代单机','二代网络','二代5G','三代网络','三代单机']
        },
        toolbox: {
            show : true,
            feature : {
                magicType : {
                    show: true,
                    type: ['pie', 'funnel'],
                    option: {
                        funnel: {
                            x: '25%',
                            width: '50%',
                            funnelAlign: 'left',
                            max: 1548
                        }
                    }
                },
                restore : {show: true},
                saveAsImage : {show: true}
            }
        },
        calculable : true,
        series : [
            {
                name:'版位总数：2310',
                type:'pie',
                radius : '55%',
                center: ['50%', '60%'],
                data:[
                    {value:335, name:'一代单机'},
                    {value:1021, name:'二代网络'},
                    {value:800, name:'二代5G'},
                    {value:1700, name:'三代网络'},
                    {value:300, name:'三代单机'},
                ]
            }
        ]
    };
    myChart.setOption(option_devicetype, true);

    $(function() {
        $('[data-toggle="popover"]').popover({trigger:"hover"});
    })
</script>