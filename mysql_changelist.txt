############################################
-------------------------
文件说明:用于记录Mysql表修改历史
2017.3.3增加该文件

格式要求:
-------------------------
修改说明:修改某某表,某某字段,修改目的
修改时间:年份.月份.日期 当前时间
修改人:XXX
Mysql语句:mysql可执行语句

#############################################


增加说明：修改版本号名称字段长度
修改时间:2017.3.6 15:51
修改人:张英涛
执行SQL:ALTER TABLE `savor_device_version`  MODIFY `version_name` VARCHAR(15) DEFAULT NULL COMMENT '版本名称';


增加说明：系统模块增加默认图与选中途
修改时间:2017.3.14 12:40
修改人:张英涛
执行SQL:ALTER TABLE savor_sysmenu ADD `media_id` INT(11) UNSIGNED NOT NULL DEFAULT '0' COMMENT '选中图标资源id' AFTER `modulename`;
ALTER TABLE savor_sysmenu ADD `select_media_id` INT(11) UNSIGNED NOT NULL DEFAULT '0' COMMENT '选中图标资源id' AFTER `media_id`;





增加说明：酒楼增加酒楼机顶盒类型
修改时间:2017.3.20 15:40
修改人:张英涛
执行SQL:ALTER TABLE `savor_hotel` ADD COLUMN `hotel_box_type` TINYINT(1) NOT NULL DEFAULT 0 COMMENT '酒楼机顶盒类型1:一代单机版2:二代网络版3:三代5G版' AFTER `remark`;

增加说明:后台增加配置切换时间和默认音量
修改时间:2017.3.20 15:40
修改人:张英涛
执行SQL: ALTER TABLE `savor_sys_config` ADD COLUMN `status` TINYINT(1) NOT NULL DEFAULT 0 COMMENT '是否开启0:未开启1:开启';





增加说明:客户端启动logo设置
修改时间:2017.3.22 10：27
修改人:白玉涛
CREATE TABLE `savor_client_start` (
  `id` smallint(5) NOT NULL AUTO_INCREMENT,
  `img_id` int(11) DEFAULT '0' COMMENT '图片id',
  `media_id` int(11) DEFAULT '0' COMMENT '视频id',
  `name` varchar(255) DEFAULT NULL COMMENT '视频名称',
  `ctype` smallint(5) DEFAULT '3' COMMENT '类型3ancroid 4ios',
  `status` int(11) DEFAULT '1' COMMENT '默认状态1启动图片2启动视频',
  `online` smallint(5) DEFAULT '1' COMMENT '0下线1上线',
  `duration` int(12) DEFAULT NULL COMMENT '视频时长',
  `create_time` datetime DEFAULT CURRENT_TIMESTAMP,
  `update_time` datetime DEFAULT CURRENT_TIMESTAMP,
  PRIMARY KEY (`id`)
) ENGINE=InnoDB AUTO_INCREMENT=2 DEFAULT CHARSET=utf8

增加说明:增加后台日志表
修改时间:2017.3.29 16：30
修改人:张英涛

CREATE TABLE `savor_admin_log`(
  `id` INT(11) NOT NULL  AUTO_INCREMENT,
  `userid` INT(11) NOT NULL DEFAULT 0 COMMENT '用户id',
  `username` VARCHAR(255) NOT NULL DEFAULT '' COMMENT '用户昵称',
  `action` VARCHAR(25) NOT NULL DEFAULT '' COMMENT '菜单',
  `query_string` TEXT COMMENT '操作数据',
  `ipaddr` VARCHAR(15) NOT NULL DEFAULT '' COMMENT 'IP',
  `addtime` DATETIME DEFAULT CURRENT_TIMESTAMP COMMENT '操作时间',
  PRIMARY KEY (`id`)
) ENGINE=MYISAM AUTO_INCREMENT=1 DEFAULT CHARSET=utf8
create_timedatetime NOT NULL创建时间

增加说明：添加机顶盒更新时间 
修改时间:2017.3.31 13:46
修改人:白玉涛
执行SQL: ALTER TABLE `savor_box` ADD COLUMN `create_time` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间';
ALTER TABLE `savor_box` ADD COLUMN `update_time` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '更新时间时间';


增加说明：修改酒楼日志字段
修改时间:2017.3.31 13:46
修改人:白玉涛
执行SQL: ALTER TABLE `savor_menulist_log` change  `hotel_id`  `hotel_id_s` text NOT NULL DEFAULT '' COMMENT '发布酒楼id字符串';

ALTER TABLE `savor_menulist_log` ADD COLUMN  `flag` text NOT NULL DEFAULT '' COMMENT '存储上一次节目单的酒店字符串';

增加说明：添加酒楼wifi及密码
修改时间:2017.4.17 16：00
修改人:白玉涛
执行SQL: 
alter table `savor_hotel` 
 add column `remote_id` varchar(255) DEFAULT '' NOT NULL COMMENT '远程ID',
   add column `hotel_wifi` varchar(255) DEFAULT '' NOT NULL COMMENT '酒楼wifi名称' after `remote_id`, 
   add column `hotel_wifi_pas` varchar(255) DEFAULT '' NOT NULL COMMENT '酒楼wifi密码' after `hotel_wifi`

#########以上sql均已执行######

增加说明：添加意见反馈手机类型
修改时间:2017.5.3 14：00
修改人:白玉涛
执行SQL: 
ALTER TABLE `cloud`.`savor_mb_feedback`     ADD COLUMN `device_type` SMALLINT(3) DEFAULT '3' NOT NULL COMMENT '类型3android4ios' AFTER `create_time`;

增加说明：添加节点表
修改时间：2017.5.5 15：00
修改人：白玉涛
执行sql:
CREATE TABLE `savor_nodemenu` (
  `id` smallint(6) unsigned NOT NULL AUTO_INCREMENT,
  `name` char(40) NOT NULL DEFAULT '',
  `nodekey` varchar(100) NOT NULL DEFAULT '' COMMENT 'config表中节点key',
  `parentid` smallint(6) NOT NULL DEFAULT '0' COMMENT '它的父id',
  `media_id` int(11) unsigned NOT NULL DEFAULT '0' COMMENT '默认图标资源id',
  `select_media_id` int(11) unsigned NOT NULL DEFAULT '0' COMMENT '选中图标资源id',
  `menulevel` tinyint(1) DEFAULT '0' COMMENT '菜单级别',
  `m` char(20) NOT NULL DEFAULT '',
  `c` char(20) NOT NULL DEFAULT '',
  `a` char(20) NOT NULL DEFAULT '',
  `displayorder` smallint(6) unsigned NOT NULL DEFAULT '0',
  `isenable` smallint(6) NOT NULL DEFAULT '1',
  `sysmenuid` int(11) NOT NULL DEFAULT '0' COMMENT '一级和二级对应sysmenu表中id',
  `ertype` smallint(2) NOT NULL DEFAULT '1' COMMENT '1:系统自带2.原生js',
  PRIMARY KEY (`id`),
  KEY `parentid` (`parentid`),
  KEY `module` (`m`,`c`,`a`)
) ENGINE=MyISAM AUTO_INCREMENT=172 DEFAULT CHARSET=utf8 COMMENT='节点表';

增加说明：权限表
修改时间：2017.5.5 15：00
修改人：白玉涛
执行sql:
CREATE TABLE `savor_role_priv` (
  `roleid` tinyint(3) unsigned NOT NULL DEFAULT '0',
  `m` char(20) NOT NULL COMMENT '模块名',
  `c` char(20) NOT NULL COMMENT '控制器名',
  `a` char(20) NOT NULL COMMENT '方法名',
  `nodeid` int(11) NOT NULL DEFAULT '0' COMMENT '节点id',
  `menulevel` tinyint(3) unsigned NOT NULL DEFAULT '0',
  `ertype` smallint(2) NOT NULL DEFAULT '1' COMMENT '1:原生2.系统自带',
  KEY `roleid` (`roleid`,`m`,`c`,`a`)
) ENGINE=MyISAM DEFAULT CHARSET=utf8 COMMENT='权限组表'
增加说明：抽奖时间配置
修改时间：2017.5.8 14：30
修改人：张英涛
执行sql:
insert into `savor_sys_config` (`config_key`,`config_value`,`status`) values('system_award_start_time','11:00',1);
insert into `savor_sys_config` (`config_key`,`config_value`,`status`) values('system_award_end_time','12:00',1);

增加说明：中奖日志表
修改时间：2017.5.8 14：30
修改人：张英涛
执行sql:
CREATE TABLE `savor_award_log` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `box_id` int(11) NOT NULL DEFAULT '0' COMMENT '机顶盒id',
  `mac` varchar(50) NOT NULL DEFAULT '' COMMENT '机顶盒mac',
  `prizeid` int(11) NOT NULL DEFAULT '0' COMMENT '奖项id',
  `device_type` tinyint(1) NOT NULL DEFAULT '0' COMMENT '客户端类型3：安卓 4：IOS',
  `deviceid` varchar(50) NOT NULL DEFAULT '' COMMENT '中奖手机设备id',
  `time` datetime DEFAULT CURRENT_TIMESTAMP COMMENT '中奖时间',
  PRIMARY KEY (`id`)
) ENGINE=MyISAM AUTO_INCREMENT=1 DEFAULT CHARSET=utf8



增加说明：奖品配置表
修改时间：2017.5.9 13：30
修改人：白玉涛
执行sql:
CREATE TABLE `savor_award_config` (
  `id` bigint(20) NOT NULL AUTO_INCREMENT,
  `name` varchar(48) DEFAULT NULL COMMENT '名称：奖品名称',
  `pos` tinyint(4) NOT NULL COMMENT '中奖概率',
  `create_time` datetime DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
  `update_time` datetime DEFAULT CURRENT_TIMESTAMP COMMENT '更新时间',
  `flag` tinyint(1) DEFAULT '0' COMMENT '标示位1正常0删除',
  `level` tinyint(1) DEFAULT '1' COMMENT '标明几等奖',
  PRIMARY KEY (`id`)
) ENGINE=InnoDB AUTO_INCREMENT=1 DEFAULT CHARSET=utf8
insert into `savor_award_config` (`id`, `name`, `pos`, `create_time`, `update_time`, `flag`, `level`) values('1','一等奖','30','2017-05-08 13:42:15','2017-05-08 13:42:15','1','1');
insert into `savor_award_config` (`id`, `name`, `pos`, `create_time`, `update_time`, `flag`, `level`) values('2','二等奖','40','2017-05-08 13:42:27','2017-05-08 13:42:27','1','2');
insert into `savor_award_config` (`id`, `name`, `pos`, `create_time`, `update_time`, `flag`, `level`) values('3','三等奖','30','2017-05-08 13:42:35','2017-05-08 13:42:35','1','3');


增加说明：机顶盒奖项表
修改时间：2017.5.9 13：30
修改人：白玉涛
CREATE TABLE `savor_box_award` (
  `id` int(5) NOT NULL AUTO_INCREMENT,
  `box_id` int(5) NOT NULL COMMENT '机顶盒id',
  `room_id` int(5) NOT NULL COMMENT '包间id',
  `hotel_id` int(5) NOT NULL COMMENT '酒楼id',
  `prize` varchar(500) DEFAULT NULL COMMENT '奖项json:奖品id,奖品名称,奖品数量,奖品概率，奖品level',
  `prize_current` varchar(500) DEFAULT NULL COMMENT '奖项json:奖品id,奖品名称,奖品数量,奖品概率，奖品level',
  `flag` tinyint(1) DEFAULT '1' COMMENT '标示位1正常0删除',
  `create_time` datetime DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
  `update_time` datetime DEFAULT CURRENT_TIMESTAMP COMMENT '更新时间',
  `date_time` varchar(20) NOT NULL DEFAULT '' COMMENT '对应批次日期',
  PRIMARY KEY (`id`),
  KEY `idx_b` (`box_id`,`create_time`)
) ENGINE=InnoDB AUTO_INCREMENT=1 DEFAULT CHARSET=utf8;


alter table `cloud`.`savor_nodemenu` 
   change `m` `m` char(20) character set utf8 collate utf8_general_ci default '' NOT NULL, 
   change `a` `a` char(30) character set utf8 collate utf8_general_ci default '' NOT NULL;

   alter table `cloud`.`savor_role_priv` 
   change `a` `a` char(30) character set utf8 collate utf8_general_ci NOT NULL comment '方法名'





增加说明：文章对应标签表
修改时间：2017.6.15 13：30
修改人：白玉涛
执行sql:
CREATE TABLE `savor_tag` (
  `article_id` int(10) DEFAULT NULL,
  `tagid` int(10) DEFAULT NULL COMMENT '标签id',
  `tagname` varchar(48) DEFAULT NULL COMMENT '标签名称',
  KEY `aid` (`article_id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8


增加说明：标签列表
修改时间：2017.6.15 13：30
修改人：白玉涛
执行sql:
CREATE TABLE `savor_taglist` (
  `id` int(10) NOT NULL AUTO_INCREMENT,
  `tagname` varchar(48) DEFAULT '' COMMENT '标签名称',
  `create_time` datetime DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
  `update_time` datetime DEFAULT CURRENT_TIMESTAMP COMMENT '更新时间',
  `flag` tinyint(1) DEFAULT '1' COMMENT '标示位1正常0删除',
  `num` smallint(6) DEFAULT '0' COMMENT '拥有标签文章的数量',
  PRIMARY KEY (`id`),
  UNIQUE KEY `tag` (`tagname`)
) ENGINE=InnoDB AUTO_INCREMENT=1 DEFAULT CHARSET=utf8

增加说明：文章内容来源
修改时间：2017.6.16 13：30
修改人：张英涛
执行sql:
CREATE TABLE `savor_article_source` (
  `id` int(11) unsigned NOT NULL AUTO_INCREMENT,
  `name` varchar(50) NOT NULL DEFAULT '' COMMENT '来源名称',
  `logo` varchar(255) NOT NULL DEFAULT '' COMMENT 'LOGO图片',
  `introduction` text COMMENT '简介',
  `add_user_id` int(11) NOT NULL DEFAULT '0' COMMENT '创建用户id',
  `add_time` datetime DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
  `edit_user_id` int(11) NOT NULL DEFAULT '0' COMMENT '编辑用户id',
  `edit_time` datetime DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
  PRIMARY KEY (`id`)
) ENGINE=MyISAM AUTO_INCREMENT=1 DEFAULT CHARSET=utf8 COMMENT='文章来源表'

增加说明：文章来源字段增加
修改时间：2017.6.16 13：30
修改人：张英涛
执行sql:
ALTER TABLE savor_mb_content ADD COLUMN `source_id` TINYINT(3) NOT NULL DEFAULT 0 COMMENT '文章内容来源' AFTER `source`

增加说明：酒店对账单联系人以及电话
修改时间：2017.6.16 13：30
修改人：白玉涛
执行sql:
ALTER TABLE `savor_hotel` ADD COLUMN `bill_per` VARCHAR(20) NOT NULL COMMENT '对账单联系人' AFTER `hotel_wifi_pas`,ADD COLUMN `bill_tel` VARCHAR(12) NOT NULL COMMENT '对账单人联系电话' AFTER `bill_per`;

增加说明：savor_hotel添加地区是否含有酒店字段
修改时间：2017.7.4 10：30
修改人：白玉涛
执行sql:
ALTER TABLE `cloud`.`savor_area_info`     ADD COLUMN `is_in_hotel` TINYINT(1) DEFAULT '0' NOT NULL COMMENT '是否含有酒楼' AFTER `is_valid`;


增加说明：发票表
修改时间：2017.7.5 11：30
修改人：白玉涛
执行sql:
CREATE TABLE `savor_account_info` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `receipt_addr` varchar(50) NOT NULL DEFAULT '' COMMENT '发票地址',
  `receipt_tel` varchar(50) NOT NULL DEFAULT '' COMMENT '发票收件人',
  `receipt_head` varchar(50) NOT NULL DEFAULT '' COMMENT '发票抬头',
  `receipt_taxnum` varchar(50) NOT NULL DEFAULT '' COMMENT '纳税人识别号',
  PRIMARY KEY (`id`)
) ENGINE=InnoDB AUTO_INCREMENT=1 DEFAULT CHARSET=utf8 COMMENT='发票表';
insert  into `savor_account_info`(`id`,`receipt_addr`,`receipt_tel`,`receipt_head`,`receipt_taxnum`) values (1,'北京市朝阳区建外大街郎家园16号永峰写字楼6层601-603室','赵翠燕,010-64185797-8016','拉萨经济技术开发区热点信息技术有限公司北京分公司','91110105MA00BKE27L'),(2,'上海市徐汇区零陵路899号飞洲国际22K室','田耘,021-34773009','拉萨经济技术开发区热点信息技术有限公司上海分公司','91310104MA1FR71647'),(3,'广州市越秀区先烈中路75号穗丰大厦A座209室','余穗筠,020-87326025','拉萨经济技术开发区热点信息技术有限公司广州分公司','91440101MA59J47E83');

增加说明：公司对账单
修改时间：2017.7.5 11：30
修改人：白玉涛
执行sql:
CREATE TABLE `savor_account_statement` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `fee_start` varchar(20) NOT NULL DEFAULT '' COMMENT '费用时间段开始',
  `fee_end` varchar(20) NOT NULL DEFAULT '' COMMENT '费用时间段结束',
  `cost_type` tinyint(3) unsigned DEFAULT '1' COMMENT '费用类型1开机2APP推广',
  `receipt_addrid` smallint(5) unsigned DEFAULT '1' COMMENT '发票地址对应id',
  `remark` text NOT NULL COMMENT '备注',
  `operatorid` int(11) NOT NULL DEFAULT '0' COMMENT '操作人id',
  `count` int(11) NOT NULL DEFAULT '0' COMMENT '酒楼id的数量',
  `create_time` datetime DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
  `update_time` datetime DEFAULT CURRENT_TIMESTAMP COMMENT '更新时间',
  `summary` text COMMENT '详细信息',
  PRIMARY KEY (`id`),
  KEY `ctune` (`create_time`)
) ENGINE=InnoDB AUTO_INCREMENT=1 DEFAULT CHARSET=utf8 COMMENT='公司对账单'

增加说明：公司对账单明细
修改时间：2017.7.5 11：30
修改人：白玉涛
执行sql:
CREATE TABLE `savor_account_statement_detail` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `hotel_id` varchar(11) DEFAULT NULL COMMENT '酒楼id',
  `check_status` tinyint(1) unsigned DEFAULT '0' COMMENT '对账状态0为未读,1为已读,2为已确认,3为已付款',
  `statement_id` int(11) DEFAULT '0' COMMENT '对应公司对账单id',
  `money` varchar(20) DEFAULT '' COMMENT '对账金额',
  `state` tinyint(3) unsigned DEFAULT '1' COMMENT '插入状态1成功2酒楼不存在3费用已经下发4对账单人联系电话为空5酒楼下发金额为负值6EXCEL表中已经存在酒楼7.酒楼下发金额为空值',
  `err_msg` varchar(50) NOT NULL DEFAULT '' COMMENT '错误原因',
  `fee_start` varchar(20) NOT NULL DEFAULT '' COMMENT '费用时间段开始',
  `fee_end` varchar(20) NOT NULL DEFAULT '' COMMENT '费用时间段结束',
  `cost_type` tinyint(3) unsigned DEFAULT '1' COMMENT '费用类型1开机2APP推广',
  `create_time` datetime DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
  `update_time` datetime DEFAULT CURRENT_TIMESTAMP COMMENT '更新时间',
  `hotel_name` varchar(20) DEFAULT '' COMMENT '错误状态下酒店名称',
  PRIMARY KEY (`id`),
  KEY `statement` (`hotel_id`,`statement_id`)
) ENGINE=InnoDB AUTO_INCREMENT=1 DEFAULT CHARSET=utf8 COMMENT='公司对账单明细'



增加说明：消息通知
修改时间：2017.7.5 11：30
修改人：白玉涛
执行sql:
CREATE TABLE `savor_account_statement_notice` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `status` tinyint(3) unsigned DEFAULT '1' COMMENT '发送状态1成功0失败',
  `detail_id` int(11) DEFAULT '0' COMMENT '对应明细账单的id',
  `f_type` tinyint(3) unsigned DEFAULT '1' COMMENT '哪种短信类型1发送录入对账单通知2确认付款完成',
  `create_time` datetime DEFAULT CURRENT_TIMESTAMP COMMENT '消息创建时间',
  `update_time` datetime DEFAULT CURRENT_TIMESTAMP COMMENT '消息更新时间',
  `count` int(11) NOT NULL DEFAULT '0' COMMENT '最大失败数量',
  PRIMARY KEY (`id`),
  KEY `hotel_id` (`detail_id`)
) ENGINE=InnoDB AUTO_INCREMENT=1 DEFAULT CHARSET=utf8 COMMENT='消息通知'

#########################以上sql均已执行###########################
增加说明：图集对应的表
修改时间：2017.6.28 14：30
修改人：白玉涛
执行sql:
CREATE TABLE `savor_mb_pictures` (
  `id` int(12) NOT NULL AUTO_INCREMENT COMMENT '主键Id',
  `contentid` int(12)  NOT NULL DEFAULT 0 COMMENT '关联content表id名称',
  `detail` text CHARACTER SET utf8 NOT NULL COMMENT '详细信息json串aid:1,atext:sdkfk',
  PRIMARY KEY (`id`)
) ENGINE=InnoDB AUTO_INCREMENT=96 DEFAULT CHARSET=utf8;
执行结果：已执行

增加说明：修改savor_admin_log的字段
修改时间：2017.6.28 14：30
修改人：白玉涛
执行sql:
ALTER TABLE `cloud`.`savor_admin_log`     CHANGE `action` `action` VARCHAR(50) CHARACTER SET utf8 COLLATE utf8_general_ci DEFAULT '' NOT NULL COMMENT '菜单';
执行结果：已执行

增加说明：文章增加新分类字段
修改时间：2017.6.28 11：30
修改人：张英涛
执行sql:
ALTER TABLE savor_mb_content ADD COLUMN `hot_category_id` SMALLINT(3)  NOT NULL DEFAULT 0 COMMENT '文章分类1：创富 2：生活 3：专题' AFTER `category_id`

UPDATE savor_mb_content SET hot_category_id=101 WHERE category_id IN(63,85)
UPDATE savor_mb_content SET hot_category_id=102 WHERE category_id IN(68,67,66,76,83,74,78,82,64,81,79,84,75,70,80,71,65,87,88)
执行结果：已执行

增加说明：新分类表
修改时间：2017.6.28 11：30
修改人：张英涛
执行sql:
CREATE TABLE `savor_mb_hot_category` (
  `id` INT(12) NOT NULL AUTO_INCREMENT COMMENT '分类表主键Id',
  `name` VARCHAR(50) CHARACTER SET utf8 NOT NULL COMMENT '名称',
  `en_name` VARCHAR(50) DEFAULT '',
  `img_url` TEXT CHARACTER SET utf8 NOT NULL COMMENT '图片Url',
  `sort_num` INT(2) NOT NULL COMMENT '排序',
  `create_time` DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
  `update_time` DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '更新时间',
  `creator_id` BIGINT(20) NOT NULL COMMENT '操作人Id',
  `state` TINYINT(4) NOT NULL DEFAULT '0' COMMENT '状态:0未删除1删除',
  PRIMARY KEY (`id`)
) ENGINE=INNODB AUTO_INCREMENT=1 DEFAULT CHARSET=latin1

#将savor_mb_category 里的数据导入到savor_mb_hot_category表里
然后增加创富生活专题三个分类 id分别为101、102 、103
执行结果：已执行

增加说明：文章表新增首页封面图、内容字数两个字段
修改时间：2017.6.28 11：30
修改人：张英涛
执行sql:
ALTER TABLE `savor_mb_content` ADD COLUMN `index_img_url` VARCHAR(255) NOT NULL DEFAULT '' COMMENT '首页封面图' AFTER `img_url`

ALTER TABLE `savor_mb_content` ADD COLUMN `content_word_num` INT(6) NOT NULL DEFAULT 0 COMMENT '内容字数'
执行结果：已执行

增加说明：savor_mb_content添加tag标签顺序
修改时间：2017.7.4 15：30
修改人：白玉涛
执行sql:
 ALTER TABLE `cloud`.`savor_mb_content`     ADD COLUMN `sort_tag` VARCHAR(100) DEFAULT '' NOT NULL COMMENT '插入顺序tag' AFTER `content_word_num`,     ADD COLUMN `order_tag` VARCHAR(100) DEFAULT '' NOT NULL COMMENT '小到大排序tag' AFTER `sort_tag`;

ALTER TABLE `cloud`.`savor_mb_content` ADD INDEX `index_order_tag` ( `order_tag` );
执行结果：已执行

增加说明：savor_account_info添加邮箱字段
修改时间：2017.7.18 10：30
修改人：白玉涛
执行sql:
ALTER TABLE `cloud`.`savor_account_info`     ADD COLUMN `receipt_email` VARCHAR(50) DEFAULT '' NULL COMMENT '邮箱地址' AFTER `receipt_taxnum`,    CHANGE `receipt_taxnum` `receipt_taxnum` VARCHAR(50) DEFAULT '' NOT NULL COMMENT '纳税人识别号';


UPDATE `cloud`.`savor_account_info` SET `receipt_email`='zhao.cuiyan@savor.cn' WHERE `id`='1';
UPDATE `cloud`.`savor_account_info` SET `receipt_email`='tian.yun@savor.cn' WHERE `id`='2';
UPDATE `cloud`.`savor_account_info` SET `receipt_email`='yu.suijun@savor.cn' WHERE `id`='3';
执行结果：已执行

增加说明：savor_hotel添加收款公司名称，银行账号，开户行名称账号
修改时间：2017.7.18 10：30
修改人：白玉涛
执行sql: ALTER TABLE `cloud`.`savor_hotel`     ADD COLUMN `collection_company` VARCHAR(50) DEFAULT '' NOT NULL COMMENT '收款公司名称' AFTER `bill_tel`,     ADD COLUMN `bank_account` VARCHAR(50) DEFAULT '' NOT NULL COMMENT '银行账号' AFTER `collection_company`,     ADD COLUMN `bank_name` VARCHAR(50) DEFAULT '' NOT NULL COMMENT '开户行名称' AFTER `bank_account`;
执行结果：已执行




增加说明：savor_account_msg_log
修改时间：2017.7.18 10：30
修改人：白玉涛
执行sql:
CREATE TABLE `savor_account_msg_log` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `status` tinyint(3) unsigned DEFAULT '1' COMMENT '发送状态1成功0失败',
  `type` tinyint(3) unsigned DEFAULT '1' COMMENT '付款模板类型1billid 2paymentid',
  `detail_id` int(11) DEFAULT '0' COMMENT '对应明细账单的id',
  `hotel_id` int(11) DEFAULT '0' COMMENT '对应酒店id',
  `create_time` datetime DEFAULT CURRENT_TIMESTAMP COMMENT '消息创建时间',
  `update_time` datetime DEFAULT CURRENT_TIMESTAMP COMMENT '消息更新时间',
  `url` varchar(50) NOT NULL DEFAULT '' COMMENT 'url地址',
  `smsId` varchar(50) DEFAULT '' COMMENT 'SMSid',
  `tel` varchar(13) DEFAULT '' COMMENT '电话号',
  `resp_code` varchar(50) DEFAULT '' COMMENT '返回状态码',
  `msg_type` tinyint(4) NOT NULL DEFAULT '1' COMMENT '默认1为营销类短信',
  PRIMARY KEY (`id`),
  KEY `hotel_id` (`detail_id`)
) ENGINE=InnoDB AUTO_INCREMENT=1 DEFAULT CHARSET=utf8 COMMENT='电话发送短信通知LOG'
执行结果：已执行

增加说明：活动配置表
修改时间：2017.8.1 9：40
修改人：张英涛
执行sql:
CREATE TABLE `savor_activity_config` (
  `id` int(11) NOT NULL AUTO_INCREMENT COMMENT '主键ID',
  `name` varchar(50) NOT NULL DEFAULT '' COMMENT '活动名称',
  `img_url` varchar(255) NOT NULL DEFAULT '' COMMENT '封面图',
  `start_time` datetime DEFAULT CURRENT_TIMESTAMP COMMENT '活动开始时间',
  `end_time` datetime DEFAULT CURRENT_TIMESTAMP COMMENT '活动结束时间',
  `goods_nums` int(11) DEFAULT NULL COMMENT '商品名称',
  `page_views` int(11) NOT NULL DEFAULT '0' COMMENT '活动PV',
  `add_time` datetime DEFAULT CURRENT_TIMESTAMP COMMENT '添加时间',
  `edit_time` datetime DEFAULT CURRENT_TIMESTAMP COMMENT '更新时间',
  `operator_id` int(11) NOT NULL DEFAULT '0' COMMENT '操作人',
  `status` tinyint(1) NOT NULL DEFAULT '0' COMMENT '活动状态 0:未上线 1：已上线 2:删除',
  PRIMARY KEY (`id`)
) ENGINE=MyISAM AUTO_INCREMENT=1 DEFAULT CHARSET=utf8

执行结果：已执行

增加说明：活动报名表
修改时间：2017.8.1 9：40
修改人：张英涛
执行sql:
CREATE TABLE `savor_activity_data` (
  `id` int(11) NOT NULL AUTO_INCREMENT COMMENT '主键ID',
  `activity_id` int(11) NOT NULL DEFAULT '0' COMMENT '活动id',
  `receiver` varchar(20) NOT NULL DEFAULT '' COMMENT '收货人',
  `mobile` varchar(11) NOT NULL DEFAULT '' COMMENT '手机号码',
  `address` varchar(255) NOT NULL DEFAULT '' COMMENT '地址',
  `remark` varchar(255) NOT NULL DEFAULT '' COMMENT '备注',
  `add_time` datetime DEFAULT CURRENT_TIMESTAMP COMMENT '添加时间',
  PRIMARY KEY (`id`)
) ENGINE=MyISAM AUTO_INCREMENT=1 DEFAULT CHARSET=utf8

执行结果：已执行

增加说明：心跳报表添加索引
修改时间：2017.8.1 18：00
修改人：白玉涛
执行sql:
ALTER TABLE `savor_heart_log` ADD INDEX `box_time` (`box_mac`,`last_heart_time`);



增加说明：文章表添加样式字段
修改时间：2017.8.30 9：00
修改人：白玉涛

执行sql:
ALTER TABLE `cloud`.`savor_mb_content`     ADD COLUMN `img_style` TINYINT(1) DEFAULT '1' NOT NULL COMMENT '图样式1小图2大图' AFTER `order_tag`;
执行结果：已执行

增加说明：添加专题组表
修改时间：2017.8.30 9：00
修改人：白玉涛
执行结果：已执行
执行sql:
CREATE TABLE `savor_special_group` (
  `id` int(12) NOT NULL AUTO_INCREMENT COMMENT '主键Id',
  `name` varchar(20) NOT NULL DEFAULT '' COMMENT '专题组名称',
  `title` varchar(50) NOT NULL DEFAULT '' COMMENT '标题',
  `img_url` varchar(200) NOT NULL DEFAULT '' COMMENT '图片Url',
  `create_time` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
  `update_time` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '更新时间',
  `creator_id` bigint(20) NOT NULL DEFAULT '0' COMMENT '操作人Id',
  `state` tinyint(4) NOT NULL DEFAULT '0' COMMENT '状态:0未发布1发布2删除',
  `desc` text NOT NULL COMMENT '简介',
  PRIMARY KEY (`id`),
  KEY `sgroup` (`state`)
) ENGINE=InnoDB AUTO_INCREMENT=1 DEFAULT CHARSET=utf8 COMMENT='专题组'


增加说明：添加专题组对应关系表
修改时间：2017.8.30 9：00
修改人：白玉涛
执行结果：已执行
执行sql:
CREATE TABLE `savor_special_relation` (
  `id` int(12) NOT NULL AUTO_INCREMENT COMMENT '主键Id',
  `sgid` int(10) NOT NULL DEFAULT '0' COMMENT '专题组id',
  `sgtype` tinyint(2) NOT NULL DEFAULT '0' COMMENT '1.文字2.文章3.图片4.小标题',
  `stext` text NOT NULL COMMENT '文字',
  `sarticleid` int(10) NOT NULL DEFAULT '0' COMMENT '文章id',
  `spictureid` int(10) NOT NULL DEFAULT '0' COMMENT '图片mediaid',
  `stitle` varchar(230) NOT NULL DEFAULT '' COMMENT '小标题',
  PRIMARY KEY (`id`),
  KEY `sg` (`sgid`)
) ENGINE=InnoDB AUTO_INCREMENT=1 DEFAULT CHARSET=utf8 COMMENT='专题组对应关系表'

增加说明：微信查看文章授权登录记录
修改时间：2017.8.28 14：00
修改人：张英涛
执行结果：测试、正式已执行
执行sql:
CREATE TABLE `savor_content_wx_auth` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `openid` varchar(50) NOT NULL DEFAULT '' COMMENT '微信openid',
  `nickname` varchar(255) NOT NULL DEFAULT '' COMMENT '微信昵称',
  `sex` varchar(5) NOT NULL DEFAULT '' COMMENT '性别',
  `country` varchar(50) NOT NULL DEFAULT '' COMMENT '国家',
  `province` varchar(50) NOT NULL DEFAULT '' COMMENT '省份',
  `city` varchar(50) NOT NULL DEFAULT '' COMMENT '城市',
  `contentid` int(11) NOT NULL DEFAULT '0' COMMENT '文章id',
  `ip_addr` varchar(15) NOT NULL DEFAULT '' COMMENT 'ip',
  `long` varchar(15) NOT NULL DEFAULT '' COMMENT '经度',
  `lat` varchar(15) NOT NULL DEFAULT '' COMMENT '维度',
  `create_time` datetime DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
  PRIMARY KEY (`id`)
) ENGINE=MyISAM DEFAULT CHARSET=utf8

增加说明：活动添加短信配置字段/活动没人限制购买数量/订单表添加购买商品id/更新洗牙卡活动的短信模版id
修改时间：2017.9.7 15：00
修改人：张英涛
执行结果:已执行
执行sql:
ALTER TABLE `savor_activity_config` ADD COLUMN `template_id` INT(11) NOT NULL DEFAULT 0 COMMENT '下单成功发送短信id' AFTER `page_views`;
ALTER TABLE `savor_activity_config` ADD COLUMN `person_order_num`  INT(11) NOT NULL DEFAULT 1 COMMENT '每人购买数量' AFTER `page_views`;
ALTER TABLE `savor_activity_data` ADD COLUMN `goods_id` INT(11) NOT NULL DEFAULT 0 COMMENT '购买商品id' AFTER `activity_id`;
UPDATE `savor_activity_config` SET template_id=107928 WHERE id=1;

增加说明：增加活动商品表
修改时间：2017.9.7 15：00
修改人：张英涛
执行结果：已执行
执行sql:
CREATE TABLE `savor_activity_goods` (
    `id` INT(11) NOT NULL AUTO_INCREMENT COMMENT '主键ID',
    `activity_id` INT(11) NOT NULL DEFAULT 0 COMMENT '活动id',
    `goods_name` VARCHAR(255) NOT NULL DEFAULT '' COMMENT '商品名称',
    `goods_img_url` VARCHAR(255) NOT NULL DEFAULT '' COMMENT '商品图片',
    `goods_nums` INT(11) NOT NULL DEFAULT 0 COMMENT '商品数量',
    `add_time` DATETIME DEFAULT CURRENT_TIMESTAMP COMMENT '添加时间',
    `edit_time` DATETIME DEFAULT CURRENT_TIMESTAMP COMMENT '更新时间',
    `operator_id` INT(11) NOT NULL DEFAULT '0' COMMENT '操作人',
    `status` TINYINT(1) NOT NULL DEFAULT '1' COMMENT '商品状态1:正常0删除',
     PRIMARY KEY (`id`)
) ENGINE=MYISAM AUTO_INCREMENT=1 DEFAULT CHARSET=utf8


增加说明：sysuser表修改字段值
修改时间：2017.9.12 15：00
修改人：白玉涛
执行sql:
ALTER TABLE `cloud`.`savor_sysuser`     CHANGE `mebId` `mebId` INT(11) DEFAULT '0' NOT NULL COMMENT '用户所属组默认0,1为运维组 ';


增加说明：添加每日知享列表
修改时间：2017.9.18 15：00
修改人：白玉涛
执行结果：已执行
执行sql:
CREATE TABLE `savor_daily_content` (
  `id` INT(12) NOT NULL AUTO_INCREMENT COMMENT '主键Id',
  `title` VARCHAR(60) NOT NULL DEFAULT '' COMMENT '标题',
  `media_id` VARCHAR(100) NOT NULL DEFAULT '' COMMENT '图片id',
  `keyword` VARCHAR(10) NOT NULL DEFAULT '' COMMENT '关键词',
  `desc` VARCHAR(220) DEFAULT '' COMMENT '简介即浓缩内容',
  `source_id` SMALLINT(3) NOT NULL DEFAULT '0' COMMENT '文章内容来源',
  `sort_tag` VARCHAR(100) NOT NULL DEFAULT '' COMMENT '插入顺序tag',
  `order_tag` VARCHAR(100) NOT NULL DEFAULT '' COMMENT '小到大排序tag',
  `create_time` DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
  `update_time` DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '更新时间',
  `creator_id` BIGINT(20) NOT NULL DEFAULT '0' COMMENT '操作人Id',
  `state` TINYINT(4) NOT NULL DEFAULT '0' COMMENT '状态:0未发布1发布2删除',
  PRIMARY KEY (`id`),
  KEY `sgroup` (`state`)
) ENGINE=INNODB AUTO_INCREMENT=1 DEFAULT CHARSET=utf8 COMMENT='每日内容列表';


增加说明：添加每日知享关系表
修改时间：2017.9.18 15：00
修改人：白玉涛
执行sql:
执行结果：已执行
DROP TABLE IF EXISTS `savor_daily_relation`;
CREATE TABLE `savor_daily_relation` (
  `id` INT(12) NOT NULL AUTO_INCREMENT COMMENT '主键Id',
  `dailyid` INT(10) NOT NULL DEFAULT '0' COMMENT '文章id',
  `dailytype` TINYINT(2) NOT NULL DEFAULT '0' COMMENT '1.文字3.图片',
  `stext` TEXT  COMMENT '文字',
  `spictureid` INT(10) NOT NULL DEFAULT '0' COMMENT '图片mediaid',
  PRIMARY KEY (`id`),
  KEY `sg` (`dailyid`)
) ENGINE=INNODB AUTO_INCREMENT=1 DEFAULT CHARSET=utf8 COMMENT='每日内容文章对应表';


增加说明：添加每日知享home表对应共同表
修改时间：2017.9.18 15：00
修改人：白玉涛
执行结果：已执行
执行sql:
CREATE TABLE `savor_daily_lk` (
  `id` INT(12) NOT NULL AUTO_INCREMENT COMMENT 'home表lkid',
  `creator_id` INT(12) NOT NULL COMMENT '操作人Id',
  `create_time` DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
  `update_time` DATETIME DEFAULT CURRENT_TIMESTAMP COMMENT '更新时间',
  `bespeak` VARCHAR(50) DEFAULT 0 COMMENT '是否预约字段   未预约为0，已预约为1',
  `bespeak_time` DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '预约时间 格式 (yyyy-MM-dd HH:mm)',
  `homestate` TINYINT(2) NOT NULL DEFAULT '1' COMMENT '0是下线1是上线',
  PRIMARY KEY (`id`)
) ENGINE=INNODB AUTO_INCREMENT=1 DEFAULT CHARSET=utf8

增加说明：添加每日知享排序列表
修改时间：2017.9.18 15：00
修改人：白玉涛
执行结果：已执行
执行sql:
CREATE TABLE `savor_daily_home` (
  `id` INT(12) NOT NULL AUTO_INCREMENT COMMENT '',
   `lkid` INT(12) NOT NULL COMMENT 'daily_lk表主键',
  `dailyid` INT(12) NOT NULL COMMENT '内容列表主键id',
  `sort_num` INT(2) NOT NULL COMMENT '排序',
  PRIMARY KEY (`id`),
  KEY `index_contentId` (`dailyid`)
) ENGINE=INNODB AUTO_INCREMENT=1 DEFAULT CHARSET=utf8;


增加说明：添加新节目单列表
修改时间：2017.9.25 15：00
修改人：白玉涛
执行sql:
CREATE TABLE `savor_programmenu_list` (
  `id` int(11) NOT NULL AUTO_INCREMENT COMMENT '节目单id',
  `menu_name` varchar(50) NOT NULL COMMENT '节目单名称',
  `hotel_num` int(3) NOT NULL DEFAULT '0' COMMENT '计算洒楼数',
  `creator_id` int(10) NOT NULL COMMENT '创建人id',
  `creator_name` varchar(15) NOT NULL COMMENT '创建人名称',
  `create_time` datetime DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
  `update_time` datetime DEFAULT CURRENT_TIMESTAMP COMMENT '更新时间',
  `state` int(2) DEFAULT NULL COMMENT '1上线，0下线',
  `menu_num` varchar(20) DEFAULT NULL COMMENT '节目单唯一标识',
  PRIMARY KEY (`id`),
  UNIQUE KEY `idx_name` (`menu_name`),
  KEY `idx_mneu` (`menu_name`,`create_time`)
) ENGINE=InnoDB AUTO_INCREMENT=1 DEFAULT CHARSET=utf8 ROW_FORMAT=DYNAMIC COMMENT='新节目单表'




增加说明：添加新节目单详细对应表
修改时间：2017.9.25 15：00
修改人：白玉涛
执行sql:
CREATE TABLE `savor_programmenu_item` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `menu_id` int(10) DEFAULT NULL COMMENT '对应的节目单id',
  `ads_id` bigint(20) DEFAULT NULL COMMENT '广告id',
  `ads_name` varchar(48) DEFAULT NULL COMMENT '广告名称',
  `location_id` tinyint(2) DEFAULT '0' COMMENT '广告位id',
  `sort_num` smallint(4) DEFAULT NULL COMMENT '节目具体内容的排序号 其中1是最大',
  `duration` int(12) DEFAULT '0' COMMENT '过期时间',
  `type` tinyint(4) DEFAULT '0' COMMENT '1广告位2节目3宣传片',
  PRIMARY KEY (`id`),
  KEY `idx_mneu_item` (`menu_id`)
) ENGINE=InnoDB AUTO_INCREMENT=1 DEFAULT CHARSET=utf8 ROW_FORMAT=DYNAMIC COMMENT='节目单详细对应表'





增加说明：添加新节目单对应酒楼表
修改时间：2017.9.25 15：00
修改人：白玉涛
执行sql:
CREATE TABLE `savor_programmenu_hotel` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `hotel_id` int(11) DEFAULT NULL,
  `menu_id` int(11) DEFAULT '0' COMMENT '节目单id',
  `operator_id` int(10) NOT NULL DEFAULT '0',
  `create_time` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
  `update_time` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '更新时间',
  `pub_time` datetime NOT NULL COMMENT '发布预约时间',
  `down_state` tinyint(1) NOT NULL DEFAULT '0' COMMENT '下载状态',
  PRIMARY KEY (`id`)
) ENGINE=InnoDB AUTO_INCREMENT=1 DEFAULT CHARSET=utf8 ROW_FORMAT=DYNAMIC COMMENT='新节目单对应酒楼表'


增加说明：添加广告投放对应多个机顶盒关系表
修改时间：2017.9.25 15：00
修改人：白玉涛
执行sql:
CREATE TABLE `savor_pub_ads_box` (
  `id` INT(12) NOT NULL AUTO_INCREMENT COMMENT '主键Id',
 `box_id` INT(12) NOT NULL AUTO_INCREMENT COMMENT '机顶盒ID',
  `pub_ads_id` INT(12) NOT NULL DEFAULT 0 COMMENT 'pub_ads表主键id',
   `location_id` INT(12) NOT NULL DEFAULT 0  COMMENT '机顶盒位置id',
    `menu_id`  INT(12) NOT NULL DEFAULT 0 COMMENT '插入当时对应节目单id',
    `create_time` DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
  `update_time` DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '更新时间',
  PRIMARY KEY (`id`),
) ENGINE=INNODB AUTO_INCREMENT=1 DEFAULT CHARSET=utf8 COMMENT='广告对应机顶盒表';


增加说明：添加广告投放表
修改时间：2017.9.25 15：00
修改人：白玉涛
执行sql:
CREATE TABLE `savor_pub_ads` (
  `id` int(12) NOT NULL AUTO_INCREMENT COMMENT '主键Id',
  `ads_id` int(12) NOT NULL DEFAULT 0 COMMENT '广告id',
   `start_date` datetime NOT NULL DEFAULT '' COMMENT '投放开始时间',
    `end_date` datetime NOT NULL DEFAULT '' COMMENT '投放结束时间',
  `play_times` tinyint NOT NULL DEFAULT 0 COMMENT '投放次数',
    `create_time` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
  `update_time` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '更新时间',
  `creator_id` bigint(20) NOT NULL DEFAULT '0' COMMENT '操作人Id',
   `state` tinyint(4) NOT NULL DEFAULT '0' COMMENT '1已经执行0未执行',
   `flag` tinyint(4) NOT NULL DEFAULT '0' COMMENT '状态:0正常1删除',
  PRIMARY KEY (`id`),
) ENGINE=InnoDB AUTO_INCREMENT=1 DEFAULT CHARSET=utf8 COMMENT='广告投放表';


=======
) ENGINE=INNODB AUTO_INCREMENT=1 DEFAULT CHARSET=utf8
增加说明：添加每日知享排序列表
修改时间：2017.9.18 15：00
修改人：张英涛
执行结果：已执行
执行sql:
CREATE TABLE `savor_daily_collection` (
  `id` int(11) NOT NULL AUTO_INCREMENT COMMENT '主键Id',
  `dailyid` int(11) NOT NULL DEFAULT '0' COMMENT '文章id',
  `device_id` varchar(50) NOT NULL DEFAULT '' COMMENT '设备号',
  `create_time` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
  `update_time` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '更新时间',
  `state` tinyint(2) NOT NULL DEFAULT '0' COMMENT '状态:0未收藏1收藏',
  PRIMARY KEY (`id`)
) ENGINE=MyISAM AUTO_INCREMENT=139 DEFAULT CHARSET=utf8 COMMENT='知享收藏表';



增加说明：添加每日知享表内容属性字段
修改时间：2017.10.16 15：00
修改人：白玉涛
执行结果：已执行
执行sql:
ALTER TABLE `cloud`.`savor_daily_content`     ADD COLUMN `artpro` VARCHAR(20) DEFAULT '' NOT NULL COMMENT '内容属性' AFTER `state`;


增加说明：添加每日知享微信分享对应文章表
修改时间：2017.10.16 15：00
执行结果：已执行
修改人：白玉涛
执行sql:
CREATE TABLE `savor_daily_share_weixin` (
  `id` INT(12) NOT NULL AUTO_INCREMENT COMMENT '主键Id',
  `sourceid` VARCHAR(255) NOT NULL DEFAULT '' COMMENT '分享来源微信号',
  `openid` VARCHAR(255) NOT NULL DEFAULT '' COMMENT '微信号',
  `artid` INT(12) NOT NULL DEFAULT '0' COMMENT '文章id',
  `create_time` DATETIME DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
  `update_time` DATETIME DEFAULT CURRENT_TIMESTAMP COMMENT '更新时间',
  `state` TINYINT(2) NOT NULL DEFAULT '1' COMMENT '状态:0删除1正常',
  PRIMARY KEY (`id`),
  KEY `idx_devic` (`openid`,`state`)
) ENGINE=INNODB DEFAULT CHARSET=utf8 COMMENT='每日知享微信分享表';



增加说明：添加每日知享登录用户表
修改时间：2017.10.16 15：00
修改人：白玉涛
执行结果：已执行
执行sql:
CREATE TABLE `savor_daily_user` (
  `id` int(12) NOT NULL AUTO_INCREMENT COMMENT '主键Id',
  `device_id` varchar(25) NOT NULL DEFAULT '' COMMENT '设备号',
  `openid` varchar(25) NOT NULL DEFAULT '' COMMENT '微信号',
  `tel` varchar(12) NOT NULL DEFAULT '' COMMENT '手机号',
  `mtype` varchar(5) NOT NULL DEFAULT '' COMMENT '手机类型',
  `celltype` varchar(20) NOT NULL DEFAULT '' COMMENT '手机具体型号',
  `ptype` tinyint(2) NOT NULL DEFAULT '4' COMMENT '人群类型',
  `create_time` datetime DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
  `update_time` datetime DEFAULT CURRENT_TIMESTAMP,
  `state` tinyint(2) NOT NULL DEFAULT '1' COMMENT '状态:0删除1正常',
  PRIMARY KEY (`id`),
  KEY `idx_devic` (`openid`,`state`)
) ENGINE=InnoDB AUTO_INCREMENT=5 DEFAULT CHARSET=utf8 COMMENT='每日知享用户表'



增加说明：修改每日知享添加作者和内容表
修改时间：2017.10.16 15：00
修改人：白玉涛
执行结果：已执行
执行sql:
ALTER TABLE `cloud`.`savor_daily_lk`     ADD COLUMN `dailyauthor` VARCHAR(50) DEFAULT '' NOT NULL COMMENT '作者' AFTER `homestate`,     ADD COLUMN `dailyart` VARCHAR(150) DEFAULT '' NULL COMMENT '内容' AFTER `dailyauthor`;
/*[13:56:39][   0 ms]*/ SHOW FULL TABLES FROM `cloud` WHERE table_type = 'BASE TABLE';

增加说明：修改任务列表引擎类型
修改时间：2017.10.16 15：00
修改人：白玉涛
执行sql:
alter table `cloud`.`savor_option_task`  Engine=InnoDB auto_increment=1 comment='运维任务表' row_format=dynamic charset=utf8 collate=utf8_general_ci;


增加说明：添加任务外包表
修改时间：2017.10.16 15：00
修改人：白玉涛
执行sql:
CREATE TABLE `savor_subcontract` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `userid` int(11) NOT NULL DEFAULT '0' COMMENT '用户id',
  `bid` varchar(21) NOT NULL DEFAULT '' COMMENT '机顶盒ID',
  `remark` text COMMENT '备注',
  `hotel_id` int(11) NOT NULL DEFAULT '0' COMMENT '酒楼id',
  `repair_type` varchar(250) NOT NULL DEFAULT '' COMMENT '损坏类型1,2,3',
  `repair_img` varchar(250) NOT NULL DEFAULT '' COMMENT '损坏图片urla,b,c',
  `gps` varchar(50) NOT NULL DEFAULT '' COMMENT 'lat,lng纬经度',
  `flag` tinyint(4) NOT NULL DEFAULT '0' COMMENT '状态标识：0正常，1删除',
  `srtype` tinyint(4) NOT NULL DEFAULT '1' COMMENT '状态标识：1签到，2报修',
  `datetime` int(11) NOT NULL DEFAULT '0' COMMENT '按天格式创建日期',
  `create_time` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
  PRIMARY KEY (`id`),
  KEY `NewIndex1` (`datetime`,`hotel_id`,`bid`)
) ENGINE=InnoDB AUTO_INCREMENT=54 DEFAULT CHARSET=utf8


增加说明：系统用户组表添加城市选项
修改时间：2017.11.9
修改人：白玉涛
执行sql:
alter table `cloud`.`savor_sysusergroup`
   add column `area_city` smallint(10) DEFAULT '0' NULL COMMENT '地区id' ;


增加说明：用户投放广告表添加type区分酒楼投还是版位
修改时间：2017.11.15
修改人：白玉涛
执行sql:
alter table `cloud`.`savor_pub_ads`
add column `type` smallint(10) DEFAULT '0' NULL COMMENT '1版位2酒楼' ;

alter table `cloud`.`savor_pub_ads`
   change `state` `state` tinyint(5) default '0' NOT NULL comment '状态:0未执行1已经执行2删除3.默认选择酒楼状态';
执行结果：已执行

增加说明：投放广告对应酒楼表
修改时间：2017.11.15
修改人：白玉涛
执行sql:
CREATE TABLE `savor_pub_ads_hotel` (
  `id` int(12) NOT NULL AUTO_INCREMENT COMMENT '主键Id',
  `hotel_id` int(12) NOT NULL DEFAULT '0' COMMENT '酒楼id',
  `pub_ads_id` int(12) NOT NULL DEFAULT '0' COMMENT 'pub_ads表主键id',
  PRIMARY KEY (`id`)
) ENGINE=InnoDB AUTO_INCREMENT=1 DEFAULT CHARSET=utf8 COMMENT='广告对应酒楼'
执行结果：已执行



增加说明：选择酒楼投放广告对应错误表
修改时间：2017.11.15
修改人：白玉涛
执行sql:
CREATE TABLE `savor_pub_ads_box_error` (
  `id` int(12) NOT NULL AUTO_INCREMENT COMMENT '主键Id',
  `bid` int(12) NOT NULL DEFAULT '0' COMMENT '机顶盒ID',
  `bname` varchar(50) NOT NULL DEFAULT '' COMMENT '机顶盒名称',
  `rid` int(12) NOT NULL DEFAULT '0' COMMENT '包间id',
  `rname` varchar(50) NOT NULL DEFAULT '' COMMENT '包间名称',
  `hid` int(12) NOT NULL DEFAULT '0' COMMENT '酒店id',
  `hname` varchar(50) NOT NULL DEFAULT '' COMMENT '酒店名称',
  `pub_ads_id` int(12) NOT NULL DEFAULT '0' COMMENT 'pub_ads表主键id',
  `error_type` tinyint(1) NOT NULL DEFAULT '1' COMMENT '错误原因1:剩余广告位不足,2酒楼冻结',
  PRIMARY KEY (`id`)
) ENGINE=InnoDB AUTO_INCREMENT=1 DEFAULT CHARSET=utf8 COMMENT='广告投放机顶盒出错表'
执行结果：已执行




增加说明：机顶盒广告投放添加索引
修改时间：2017.12.06
修改人：张英涛
执行sql:
ALTER TABLE `savor_pub_ads_box` ADD INDEX box_id ( `box_id` ) 
执行结果：已执行

增加说明：广告投放表添加索引
修改时间：2017.12.06
修改人：张英涛
执行sql:
ALTER TABLE `savor_pub_ads` ADD INDEX start_date(`start_date`)
ALTER TABLE `savor_pub_ads` ADD INDEX end_date(`end_date`)
执行结果：已执行

增加说明：广告投放机顶盒表添加索引
修改时间：2017.12.07
修改人：白玉涛
执行sql:
ALTER TABLE `cloud`.`savor_pub_ads_box` ADD INDEX `pbs` (`pub_ads_id`);
执行结果：已执行

<<<<<<< HEAD

增加说明：HOTEL_EXT表增加客户端是否开启字段
修改时间：2017.12.28
修改人：白玉涛
执行sql:
ALTER TABLE `cloud`.`savor_hotel_ext` ADD COLUMN `is_open_customer`
TINYINT(1) NOT NULL DEFAULT '0' COMMENT '是否开通客户管理0:未开通1：开通';



增加说明：添加餐厅2.0客户操作历史表
修改时间：2017.12.28
修改人：白玉涛
执行sql:
CREATE TABLE `savor_dinner_action_log` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `action_id` int(11) NOT NULL DEFAULT '0' COMMENT '客户id或者预订id',
  `type` tinyint(2) NOT NULL DEFAULT '0' COMMENT '1新增2查看3修改4预订',
  `create_time` datetime DEFAULT CURRENT_TIMESTAMP,
  `invite_id` int(11) NOT NULL DEFAULT '0' COMMENT '邀请id区分出酒楼',
  PRIMARY KEY (`id`)
) ENGINE=InnoDB AUTO_INCREMENT=1 DEFAULT CHARSET=utf8 COMMENT='客户历史记录表'


增加说明：添加餐厅2.0客户消费记录表
修改时间：2017.12.28
修改人：白玉涛
执行sql:
CREATE TABLE `savor_dinner_consume_record` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `customer_id` int(11) NOT NULL DEFAULT '0' COMMENT '客户id',
  `order_id` int(11) NOT NULL DEFAULT '0' COMMENT '预订信息id',
  `name` varchar(50) NOT NULL DEFAULT '' COMMENT '名称',
  `mobile` varchar(20) NOT NULL DEFAULT '' COMMENT '手机号',
  `recipt` varchar(50) NOT NULL DEFAULT '' COMMENT '小票截图',
  `create_time` datetime DEFAULT CURRENT_TIMESTAMP,
  `update_time` datetime DEFAULT CURRENT_TIMESTAMP,
  `flag` tinyint(1) NOT NULL DEFAULT '0' COMMENT '删除状态0:正常1：删除',
  `invite_id` int(11) NOT NULL DEFAULT '0' COMMENT '邀请id',
  PRIMARY KEY (`id`)
) ENGINE=InnoDB AUTO_INCREMENT=1 DEFAULT CHARSET=utf8 COMMENT='消费记录';


增加说明：添加餐厅2.0客户表
修改时间：2017.12.28
修改人：白玉涛
执行sql:
CREATE TABLE `savor_dinner_customer` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `invite_id` int(11) NOT NULL DEFAULT '0' COMMENT '邀请id',
  `name` varchar(50) NOT NULL DEFAULT '0' COMMENT '名称',
  `mobile` varchar(20) NOT NULL DEFAULT '' COMMENT '手机号',
  `mobile1` varchar(20) NOT NULL DEFAULT '' COMMENT '手机号2',
  `sex` tinyint(1) NOT NULL DEFAULT '0' COMMENT '性别 1：男2：女',
  `birthday` varchar(11) NOT NULL DEFAULT '' COMMENT '生日',
  `birthplace` varchar(255) NOT NULL DEFAULT '' COMMENT '籍贯',
  `face_url` varchar(255) NOT NULL DEFAULT '' COMMENT '头像',
  `create_time` datetime DEFAULT CURRENT_TIMESTAMP,
  `update_time` datetime DEFAULT CURRENT_TIMESTAMP,
  `flag` tinyint(1) NOT NULL DEFAULT '0' COMMENT '删除状态0:正常1：删除',
  `consume_ability` tinyint(1) unsigned NOT NULL DEFAULT '1' COMMENT '消费能力',
  `bill_info` varchar(255) NOT NULL DEFAULT '' COMMENT '发票文字',
  `remark` text COMMENT '备注',
  PRIMARY KEY (`id`)
) ENGINE=InnoDB AUTO_INCREMENT=101 DEFAULT CHARSET=utf8


增加说明：添加餐厅2.0客户标签表
修改时间：2017.12.28
修改人：白玉涛
执行sql:
CREATE TABLE `savor_dinner_customer_label` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `customer_id` int(11) NOT NULL DEFAULT '0' COMMENT '客户id',
  `label_id` int(11) NOT NULL DEFAULT '0' COMMENT '标签id',
  `flag` tinyint(1) NOT NULL DEFAULT '0' COMMENT '删除状态0:正常1：删除',
  `create_time` datetime DEFAULT CURRENT_TIMESTAMP,
  `update_time` datetime DEFAULT CURRENT_TIMESTAMP,
  PRIMARY KEY (`id`)
) ENGINE=InnoDB AUTO_INCREMENT=7 DEFAULT CHARSET=utf8 COMMENT='客户标签表';


增加说明：添加餐厅2.0总标签库
修改时间：2017.12.28
修改人：白玉涛
执行sql:
CREATE TABLE `savor_dinner_label` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `name` varchar(20) NOT NULL DEFAULT '' COMMENT '标签名称',
  `flag` tinyint(1) NOT NULL DEFAULT '0' COMMENT '删除状态0:正常1：删除',
  `create_time` datetime DEFAULT CURRENT_TIMESTAMP,
  `update_time` datetime DEFAULT CURRENT_TIMESTAMP,
  PRIMARY KEY (`id`)
) ENGINE=InnoDB AUTO_INCREMENT=1 DEFAULT CHARSET=utf8 COMMENT='餐厅端总标签库';

增加说明：添加餐厅2.0销售经理标签库
修改时间：2017.12.28
修改人：白玉涛
执行sql:

CREATE TABLE `savor_dinner_manager_label` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `invite_id` int(11) NOT NULL DEFAULT '0' COMMENT '销售经理id',
  `label_id` int(11) NOT NULL DEFAULT '0' COMMENT '标签id',
  `flag` tinyint(1) NOT NULL DEFAULT '0' COMMENT '删除状态0:正常1：删除',
  `create_time` datetime DEFAULT CURRENT_TIMESTAMP,
  `update_time` datetime DEFAULT CURRENT_TIMESTAMP,
  PRIMARY KEY (`id`)
) ENGINE=InnoDB AUTO_INCREMENT=1 DEFAULT CHARSET=utf8 COMMENT='销售经理标签表'


增加说明：HOTEL_invite_code表增加昵称字段
修改时间：2017.12.28
修改人：白玉涛
执行sql:
alter table `cloud`.`savor_hotel_invite_code` add column `nickname`
varchar(50) not null default '' comment 'nickname';


增加说明：pub_ads表增加是否被移除到历史字段
修改时间：2017.12.28
修改人：白玉涛
执行sql:
alter table `cloud`.`savor_pub_ads` add column `is_remove`
tinyint(2) not null default 0 comment '0未1已经被移除';

增加说明：ads表增加更新时间
修改时间：2017.12.28
修改人：张英涛
执行sql:
ALTER TABLE savor_ads ADD COLUMN `update_time`   DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '更新时间'  AFTER `create_time` 
执行结果:已执行


增加说明：增加机顶盒错误日志历史表
修改时间：2017.12.28
修改人：白玉涛
执行结果：已执行
执行sql:
CREATE TABLE `savor_pub_ads_box_error_history` (
  `id` INT(12) NOT NULL AUTO_INCREMENT COMMENT '主键Id',
  `bid` INT(12) NOT NULL DEFAULT '0' COMMENT '机顶盒ID',
  `bname` VARCHAR(50) NOT NULL DEFAULT '' COMMENT '机顶盒名称',
  `rid` INT(12) NOT NULL DEFAULT '0' COMMENT '包间id',
  `rname` VARCHAR(50) NOT NULL DEFAULT '' COMMENT '包间名称',
  `hid` INT(12) NOT NULL DEFAULT '0' COMMENT '酒店id',
  `hname` VARCHAR(50) NOT NULL DEFAULT '' COMMENT '酒店名称',
  `pub_ads_id` INT(12) NOT NULL DEFAULT '0' COMMENT 'pub_ads表主键id',
  `error_type` TINYINT(1) NOT NULL DEFAULT '1' COMMENT '错误原因1:剩余广告位不足,2酒楼冻结',
  PRIMARY KEY (`id`)
) ENGINE=INNODB AUTO_INCREMENT=1 DEFAULT CHARSET=utf8 COMMENT='广告投放机顶盒出错历史表'


增加说明：增加机顶盒日志历史表
修改时间：2017.12.28
修改人：白玉涛
执行结果：已执行
执行sql:
CREATE TABLE `savor_pub_ads_box_history` (
  `id` int(12) NOT NULL AUTO_INCREMENT COMMENT '主键Id',
  `box_id` int(12) NOT NULL DEFAULT '0' COMMENT '机顶盒ID',
  `pub_ads_id` int(12) NOT NULL DEFAULT '0' COMMENT 'pub_ads表主键id',
  `location_id` int(12) NOT NULL DEFAULT '0' COMMENT '机顶盒位置id',
  `ctime` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '原来的旧表创建时间',
  `create_time` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '从表里挪移过来创建时间',
  `update_time` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '更新时间',
  `down_state` tinyint(1) NOT NULL DEFAULT '0' COMMENT '机顶盒下载状态',
  PRIMARY KEY (`id`),
  KEY `box_id` (`box_id`),
  KEY `pbs` (`pub_ads_id`)
) ENGINE=InnoDB AUTO_INCREMENT=1 DEFAULT CHARSET=utf8 COMMENT='广告对应机顶盒历史表'





增加说明：增加U盘节目单
修改时间：2018.1.8
修改人：白玉涛
执行sql:
CREATE TABLE `savor_singlezip_list` (
  `id` bigint(20) NOT NULL AUTO_INCREMENT,
  `hotel_id_str` text NOT NULL COMMENT '酒楼id字符串json{1,2,3,4}',
  `create_time` datetime DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
  `update_time` datetime DEFAULT CURRENT_TIMESTAMP COMMENT '更新时间',
  `creator_id` int(5) NOT NULL DEFAULT '0',
  `gendir` varchar(50) NOT NULL DEFAULT '' COMMENT 'public下生成的目录',
  `state` int(2) NOT NULL DEFAULT '0' COMMENT '0未执行计划1已经执行2删除',
  PRIMARY KEY (`id`)
) ENGINE=InnoDB AUTO_INCREMENT=1 DEFAULT CHARSET=utf8 ROW_FORMAT=DYNAMIC COMMENT='u盘节目单目录'
执行结果:已执行

增加说明：宣传片增加更新时间字段
修改时间：2017.1.8
修改人：张英涛
执行sql:
alter table `cloud`.`savor_room` add column `probe`
varchar(20) not null default '' comment 'wifi探针' after `remark`;
执行结果:已执行

增加说明：包间表增加wifi探针
修改时间：2017.1.8
修改人：张英涛
执行sql:
alter table `cloud`.`savor_room` add column `probe`
varchar(20) not null default '' comment 'wifi探针' after `remark`;
执行结果:已执行

增加说明：包间表增加wifi探针
修改时间：2017.1.8
修改人：张英涛
执行sql:
ALTER TABLE `cloud`.`savor_box` ADD COLUMN `devicce_token` VARCHAR(50) NOT NULL DEFAULT '' COMMENT '机顶盒设备号' AFTER `tag`
执行结果:已执行

增加说明：u盘节目单表增加选择标志
修改时间：2017.1.8
修改人：白玉涛
ALTER TABLE `cloud`.`savor_singlezip_list`     ADD COLUMN `up_cfg` VARCHAR(100) DEFAULT '' NOT NULL COMMENT '筛选标识';

执行结果:已执行



增加说明：心跳上报增加字段
修改时间：2018.1.16
修改人：张英涛
ALTER TABLE `savor_heart_log` ADD COLUMN `pro_period` VARCHAR(50) NOT NULL DEFAULT '' COMMENT '当前节目号',
                              ADD COLUMN `adv_period` VARCHAR(50) NOT NULL DEFAULT '' COMMENT '当前宣传片期号',
			      ADD COLUMN `pro_download_period` VARCHAR(50) NOT NULL DEFAULT '' COMMENT '下载节目期号',
			      ADD COLUMN `ads_download_period` VARCHAR(50) NOT NULL DEFAULT '' COMMENT '下载广告期号';
执行结果:已执行

增加说明:RTB广告投放表
修改时间：2018.2.28
修改人：白玉涛
CREATE TABLE `savor_pub_rtbads` (
  `id` int(12) NOT NULL AUTO_INCREMENT COMMENT '主键Id',
  `ads_id` int(12) NOT NULL DEFAULT '0' COMMENT '广告id',
  `start_date` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '投放开始时间',
  `end_date` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '投放结束时间',
  `admaster_sin` varchar(255) NOT NULL DEFAULT '' COMMENT 'admaster广告监测标识',
  `create_time` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
  `update_time` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '更新时间',
  `creator_id` bigint(20) NOT NULL DEFAULT '0' COMMENT '操作人Id',
  `flag` tinyint(2) NOT NULL DEFAULT '0' COMMENT '0正常1删除',
  PRIMARY KEY (`id`),
  KEY `start_date` (`start_date`),
  KEY `end_data` (`end_date`)
) ENGINE=InnoDB AUTO_INCREMENT=1 DEFAULT CHARSET=utf8 COMMENT='rtb广告投放表';




增加说明：rtb广告对应酒楼表
修改时间：2018.2.28
修改人：白玉涛
CREATE TABLE `savor_pub_rtbads_hotel` (
  `id` int(12) NOT NULL AUTO_INCREMENT COMMENT '主键Id',
  `hotel_id` int(12) NOT NULL DEFAULT '0' COMMENT '酒楼id',
  `pub_ads_id` int(12) NOT NULL DEFAULT '0' COMMENT 'pub_ads表主键id',
  PRIMARY KEY (`id`)
) ENGINE=InnoDB AUTO_INCREMENT=1 DEFAULT CHARSET=utf8 COMMENT='RTB广告对应酒楼'


增加说明：rtb广告对应标签表
修改时间：2018.2.28
修改人：白玉涛
CREATE TABLE `savor_pub_rtbtag` (
  `pub_ads_id` int(10) DEFAULT NULL,
  `tagid` int(10) DEFAULT NULL COMMENT '标签id',
  `tagname` varchar(48) DEFAULT NULL COMMENT '标签名称',
  KEY `tag` (`tagid`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8

增加说明：rtb标签列表
修改时间：2018.2.28
修改人：白玉涛
CREATE TABLE `savor_rtbtaglist` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `tagname` varchar(255) NOT NULL DEFAULT '' COMMENT '标签名称',
  `pid` int(11) NOT NULL DEFAULT '0',
  `tag_path` varchar(255) NOT NULL DEFAULT '' COMMENT '标签路径',
  `tag_code` varchar(30) NOT NULL DEFAULT '' COMMENT '标签code',
  `create_time` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
  `flag` tinyint(2) NOT NULL DEFAULT '0' COMMENT '0正常1删除',
  PRIMARY KEY (`id`),
  KEY `NewIndex1` (`pid`)
) ENGINE=InnoDB AUTO_INCREMENT=1 DEFAULT CHARSET=utf8 ROW_FORMAT=DYNAMIC COMMENT='rtb标签列表'

增加说明：餐厅标签增加默认标签字段
修改时间：2017.1.8
修改人：白玉涛
alter table `cloud`.`savor_dinner_label`
   add `default_tag`  tinyint(2) default '0' NOT NULL comment '1是默认标签0是非默认标签'
执行结果:已执行

增加说明：增加推送日志
修改时间：2017.2.1
修改人：张英涛  
CREATE TABLE savor_push_log(
	`id` INT(11) UNSIGNED NOT NULL AUTO_INCREMENT COMMENT '自增ID',
	`probe` VARCHAR(20) NOT NULL DEFAULT '' COMMENT 'wifi探针',
	 `hotel_id` INT(11) NOT NULL DEFAULT 0 COMMENT '酒楼id',
	 `room_id` INT(11) NOT NULL DEFAULT 0 COMMENT '包间id',
	`box_id` INT(11) NOT NULL DEFAULT 0 COMMENT '机顶盒id',
	`push_info` VARCHAR(255) NOT NULL DEFAULT '' COMMENT '推送数据',
	`push_time` DATETIME DEFAULT CURRENT_TIMESTAMP COMMENT '推送时间',
	`push_type` SMALLINT(3) NOT NULL DEFAULT 0 COMMENT '推送类型1:rtb广告',
	PRIMARY KEY (`id`)
)ENGINE=INNODB AUTO_INCREMENT=1 DEFAULT CHARSET=utf8

增加说明：运维端角色添加选择酒楼字段
修改时间：2018.2.1
修改人：白玉涛
ALTER TABLE `savor_opuser_role` ADD COLUMN `hotel_info` text NOT NULL COMMENT '选择酒楼';
执行结果:已执行


增加说明：添加酒楼异常详情排序表
修改时间：2018.2.1
修改人：白玉涛
CREATE TABLE `savor_hotel_unusual_report` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `hotel_id` int(11) NOT NULL DEFAULT '0',
  `box_lost_hour` int(11) NOT NULL DEFAULT '0' COMMENT '酒楼机顶盒失联总时长',
  `not_normal_box_num` int(11) NOT NULL DEFAULT '0' COMMENT '异常机顶盒数量',
  `box_num` int(11) NOT NULL DEFAULT '0' COMMENT '机顶盒总数非删除',
  `not_box_percent` varchar(10) NOT NULL DEFAULT '0' COMMENT '异常机顶盒百分比',
  `small_plat_status` tinyint(1) NOT NULL DEFAULT '0' COMMENT '小平台异常状态0：异常 1：正常2虚拟小平台',
  `small_plat_report_time` varchar(20) NOT NULL DEFAULT '' COMMENT '小平台最后上报时间',
  `pla_lost_hour` int(11) NOT NULL DEFAULT '0' COMMENT '小平台失联时长',
  `create_time` datetime DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
  `update_time` datetime DEFAULT CURRENT_TIMESTAMP COMMENT '更新时间',
  PRIMARY KEY (`id`)
) ENGINE=InnoDB AUTO_INCREMENT=1 DEFAULT CHARSET=utf8 ROW_FORMAT=DYNAMIC
执行结果:已执行


增加说明：修改酒楼表添加合作人ID字段
修改时间：2018.2.1
修改人：白玉涛
ALTER TABLE `cloud`.`savor_hotel_ext`     ADD COLUMN `maintainer_id` INT(10) NOT NULL DEFAULT '0'  COMMENT '合作维护人id'  ;
执行结果:已执行

增加说明：修改酒楼表添加合作人ID字段
修改时间：2018.2.1
修改人：白玉涛
CREATE TABLE `savor_hotel_device_token` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `user_id` int(11) DEFAULT '0',
  `v_type` smallint(4) DEFAULT '1' COMMENT '类型版本',
  `device_type` tinyint(2) DEFAULT '3' COMMENT '3android,4ios',
  `device_token` varchar(255) COLLATE utf8_unicode_ci DEFAULT '' COMMENT '版本用户的token',
  `flag` int(11) DEFAULT '0' COMMENT '0正常1删除',
  PRIMARY KEY (`id`)
) ENGINE=InnoDB AUTO_INCREMENT=24 DEFAULT CHARSET=utf8 COLLATE=utf8_unicode_ci COMMENT='任务推送device_token用户表'
执行结果:已执行

增加说明：机顶盒添加是否广告机字段
修改时间：2018.2.1
修改人：白玉涛
alter table `cloud`.`savor_box`
   add column `adv_mach` tinyint(4) DEFAULT '0' NOT NULL COMMENT '0是广告机1不是' after `update_time`;
执行结果:已执行

增加说明：hotel_ext添加是否广告机字段
修改时间：2018.2.1
修改人：白玉涛
   ALTER TABLE `cloud`.`savor_hotel_ext`     ADD COLUMN `adplay_num` INT(11) DEFAULT '0' NOT NULL COMMENT '酒楼下广告机数量' AFTER `maintainer_id`;
执行结果:已执行  
   
增加说明：创建聚屏广告表
修改时间：2018.4.9
修改人：张英涛
CREATE TABLE savor_pub_poly_ads(
	`id` INT(11) NOT NULL AUTO_INCREMENT COMMENT '主键Id',
	`ads_id` INT(11) NOT NULL DEFAULT 0 COMMENT '广告id',
	`tpmedia_id` INT(11) NOT NULL DEFAULT 0 COMMENT '第三方媒体id',
	`start_date` DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '投放开始时间',
	`end_date` DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '投放结束时间',
	`media_md5` VARCHAR(32) NOT NULL DEFAULT '' COMMENT '资源md5',
	`create_time` DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
	`update_time` DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '更新时间',
	`creator_id` INT(11) NOT NULL DEFAULT 0 COMMENT '操作人Id',
	`state` TINYINT(1) NOT NULL DEFAULT 0 COMMENT '状态：0下线1上线', 
	`flag` TINYINT(2) NOT NULL DEFAULT 0 COMMENT '0正常1删除',
	PRIMARY KEY (`id`)
)ENGINE=INNODB AUTO_INCREMENT=1 DEFAULT CHARSET=utf8 COMMENT='聚屏广告投放表'  
执行结果:已执行

增加说明：机顶盒表增加聚屏广告第三方媒体id
修改时间：2018.4.12
修改人：张英涛
ALTER TABLE savor_box ADD COLUMN `tpmedia_id` VARCHAR(50) NOT NULL DEFAULT '' COMMENT '第三方媒体聚屏id';
执行结果:已执行

增加说明：SD卡异常上报日志表
修改时间：2018.5.10
修改人：张英涛 
CREATE TABLE `savor_sdk_error` (
  `id` int(11) NOT NULL AUTO_INCREMENT COMMENT '主键Id',
  `box_id` int(11) NOT NULL DEFAULT '0' COMMENT '机顶盒id',
  `erro_count` int(11) NOT NULL DEFAULT '0' COMMENT '上报次数',
  `last_report_date` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '最后上报时间',
  PRIMARY KEY (`id`)
) ENGINE=InnoDB AUTO_INCREMENT=1 DEFAULT CHARSET=utf8
执行结果:已执行  2018.5.10

增加说明：增加运维表的用户手机字段
修改时间：2018.5.15
修改人：张英涛 
ALTER TABLE savor_opuser_role ADD COLUMN `mobile` VARCHAR(25) NOT NULL DEFAULT '' COMMENT '联系电话' AFTER manage_city	; 
执行结果:已执行  2018.5.20

增加说明：心跳表增加机顶盒心在速度字段
修改时间：2018.5.31
修改人：张英涛 
ALTER TABLE savor_heart_log ADD COLUMN `net_speed` VARCHAR(20) NOT NULL DEFAULT '' COMMENT '机顶盒下载速度'


增加说明：互动游戏增加埋点
修改时间：2018.9.5
修改人：张英涛 

ALTER TABLE savor_smallapp_turntable_log ADD COLUMN `orggame_time` BIGINT(13) NOT NULL DEFAULT 0 COMMENT '发起时间',
ADD COLUMN `box_orggame_time` BIGINT(13) NOT NULL DEFAULT 0 COMMENT '机顶盒收到发起游戏指令时间',
ADD COLUMN `startgame_time` BIGINT(13) NOT NULL DEFAULT 0 COMMENT '开始游戏时间',
ADD COLUMN `box_startgame_time` BIGINT(13) NOT NULL DEFAULT 0 COMMENT '机顶盒收到开始游戏时间',
ADD COLUMN `play_times` TINYINT(3) NOT NULL DEFAULT 0 COMMENT '玩游戏次数'

增加说明：互动游戏增加埋点
修改时间：2018.9.5
修改人：张英涛 

ALTER TABLE savor_smallapp_turntable_detail ADD COLUMN `join_time` BIGINT(13) NOT NULL DEFAULT 0 COMMENT '加入时间',
ADD COLUMN `box_join_time` BIGINT(13) NOT NULL DEFAULT 0 COMMENT '机顶盒收到用户加入时间'

增加说明：图片、视频投屏增加埋点
修改时间：2018.9.5
修改人：张英涛 
ALTER TABLE savor_smallapp_forscreen_record ADD COLUMN `resource_id` BIGINT(13) NOT NULL DEFAULT 0 COMMENT '资源id' AFTER id

ALTER TABLE savor_smallapp_forscreen_record ADD COLUMN `res_sup_time` BIGINT(13) NOT NULL DEFAULT 0 COMMENT '资源开始长传时间',
ADD COLUMN `res_eup_time` BIGINT(13) NOT NULL DEFAULT 0 COMMENT '资源上传成功时间',
ADD COLUMN `box_res_sdown_time` BIGINT(13) NOT NULL DEFAULT 0 COMMENT '机顶盒开始下载资源时间',
ADD COLUMN `box_res_edown_time` BIGINT(13) NOT NULL DEFAULT 0 COMMENT '机顶盒下载资源完成时间'

增加说明：新增红包业务相关表
修改时间：2019-02-25 18:33
修改人：刘斌
执行SQL：

ALTER TABLE `cloud`.`savor_smallapp_user`
ADD COLUMN `mpopenid` varchar(100) NOT NULL DEFAULT '' COMMENT '微信服务号用户openid' AFTER `is_wx_auth`;

CREATE TABLE `savor_smallapp_redpacket` (
  `id` bigint(16) NOT NULL AUTO_INCREMENT,
  `user_id` int(11) NOT NULL COMMENT '用户ID',
  `total_fee` decimal(10,2) NOT NULL DEFAULT '0.00' COMMENT '总金额',
  `pay_fee` decimal(10,2) NOT NULL DEFAULT '0.00' COMMENT '支付金额',
  `amount` int(11) unsigned NOT NULL DEFAULT '0' COMMENT '红包个数',
  `surname` varchar(30) NOT NULL DEFAULT '' COMMENT '姓名',
  `sex` tinyint(1) NOT NULL DEFAULT '1' COMMENT '性别 1男,2女',
  `bless_id` tinyint(1) NOT NULL DEFAULT '1' COMMENT '祝福语id',
  `scope` tinyint(1) NOT NULL DEFAULT '1' COMMENT '发送范围 1全网餐厅电视,2当前餐厅所有电视,3当前包间电视',
  `mac` varchar(12) NOT NULL DEFAULT '' COMMENT 'mac地址',
  `status` tinyint(1) unsigned NOT NULL DEFAULT '0' COMMENT '0:未付款,1:付款码到电视,2:付款中,3:付款失败,4:付款成功,5:已抢完,6未抢完,7已退款',
  `pay_time` timestamp NULL DEFAULT NULL COMMENT '付款时间',
  `grab_time` timestamp NULL DEFAULT NULL COMMENT '红包抢完时间',
  `pay_type` int(5) NOT NULL DEFAULT '0' COMMENT '0未知 10微信支付',
  `isdel` tinyint(1) NOT NULL COMMENT '是否删除 0未删除 1删除',
  `add_time` timestamp NULL DEFAULT CURRENT_TIMESTAMP COMMENT '添加时间',
  PRIMARY KEY (`id`),
  KEY `key_status` (`status`)
) ENGINE=InnoDB AUTO_INCREMENT=1000 DEFAULT CHARSET=utf8 COMMENT='红包';

CREATE TABLE `savor_smallapp_redpacket_receive` (
  `id` bigint(16) NOT NULL AUTO_INCREMENT,
  `redpacket_id` int(11) NOT NULL COMMENT '红包id',
  `user_id` int(11) NOT NULL COMMENT '领取用户id',
  `money` decimal(10,2) NOT NULL DEFAULT '0.00' COMMENT '红包金额',
  `barrage` varchar(150) NOT NULL DEFAULT '' COMMENT '弹幕',
  `status` tinyint(1) NOT NULL DEFAULT '0' COMMENT '状态 0 未领取 1已领取',
  `receive_time` timestamp NULL DEFAULT NULL COMMENT '领取时间',
  `add_time` timestamp NULL DEFAULT CURRENT_TIMESTAMP COMMENT '添加时间',
  PRIMARY KEY (`id`),
  KEY `key_redstatus` (`redpacket_id`,`status`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COMMENT='红包领取记录';


CREATE TABLE `savor_smallapp_orderserial` (
  `id` int(13) unsigned NOT NULL AUTO_INCREMENT COMMENT '自增ID',
  `trade_no` varchar(30) NOT NULL DEFAULT '' COMMENT '订单号',
  `serial_order` varchar(200) NOT NULL DEFAULT '' COMMENT '第三方流水号',
  `goods_id` int(11) NOT NULL DEFAULT '0' COMMENT '产品ID',
  `pay_type` int(5) NOT NULL DEFAULT '0' COMMENT '0未知 10 微信支付',
  `add_time` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '添加时间',
  PRIMARY KEY (`id`),
  KEY `trade_no` (`trade_no`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8 ROW_FORMAT=DYNAMIC COMMENT='订单流水号记录';

CREATE TABLE `savor_smallapp_refund` (
  `id` bigint(20) NOT NULL AUTO_INCREMENT COMMENT '自增ID',
  `trade_no` varchar(50) DEFAULT NULL COMMENT '订单号',
  `user_id` int(11) unsigned NOT NULL COMMENT '购买用户ID',
  `refund_money` decimal(9,2) DEFAULT '0.00' COMMENT '退款金额',
  `goods_id` int(11) NOT NULL DEFAULT '0' COMMENT '商品ID',
  `batch_no` varchar(200) CHARACTER SET utf8 COLLATE utf8_bin DEFAULT NULL COMMENT '退款批次号',
  `detail_data` varchar(200) CHARACTER SET utf8 COLLATE utf8_bin DEFAULT NULL COMMENT '退款数据',
  `code_str` varchar(200) NOT NULL DEFAULT '' COMMENT '退款的票号',
  `type` tinyint(1) unsigned NOT NULL DEFAULT '0' COMMENT '0整单退1部分退',
  `status` tinyint(1) unsigned NOT NULL DEFAULT '0' COMMENT '0未处理1已提交至第三方2退款完成',
  `reason_way` tinyint(1) DEFAULT '1' COMMENT '退款方式1原路退回2退银行卡',
  `reason_type` tinyint(1) DEFAULT '1' COMMENT '原因类型',
  `refund_time` timestamp NULL DEFAULT NULL COMMENT '退款时间',
  `succ_time` timestamp NULL DEFAULT NULL COMMENT '完成时间',
  `add_time` timestamp NULL DEFAULT CURRENT_TIMESTAMP COMMENT '添加时间',
  PRIMARY KEY (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COMMENT='退款';

增加说明：新增互动广告
修改时间：2019-03-19 14:00
修改人：刘斌
执行SQL：

ALTER TABLE `cloud`.`savor_ads`
ADD COLUMN `resource_type` tinyint(1) NOT NULL DEFAULT 1 COMMENT '资源类型1视频,2图片' AFTER `checker_id`;
ALTER TABLE `cloud`.`savor_box`
ADD COLUMN `is_open_interactscreenad` tinyint(1) NOT NULL DEFAULT 0 COMMENT '是否开启互动投屏广告' AFTER `is_open_simple`;
ALTER TABLE `cloud`.`savor_ads`
MODIFY COLUMN `type` tinyint(2) NOT NULL COMMENT '1广告，2节目，3宣传片 4B类广告 5聚屏广告 6投屏广告' AFTER `resource_type`;
INSERT INTO `cloud`.`savor_sys_config`(`config_key`, `config_value`) VALUES ('system_sapp_forscreen_nums', '2')

CREATE TABLE `savor_forscreen_ads` (
  `id` int(12) NOT NULL AUTO_INCREMENT COMMENT '主键Id',
  `ads_id` int(12) NOT NULL DEFAULT '0' COMMENT '广告id',
  `start_date` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '投放开始时间',
  `end_date` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '投放结束时间',
  `play_position` tinyint(1) NOT NULL DEFAULT '0' COMMENT '播放位置1：投屏前2：投屏后',
  `cover_img_media_id` bigint(20) NOT NULL DEFAULT '0' COMMENT '封面图资源id',
  `creator_id` bigint(20) NOT NULL DEFAULT '0' COMMENT '操作人Id',
  `state` tinyint(1) NOT NULL DEFAULT '0' COMMENT '状态:0未执行,1执行中,2可用,3不可用,4已删除',
  `type` smallint(10) NOT NULL DEFAULT '0' COMMENT '1版位2酒楼',
  `create_time` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
  `update_time` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '更新时间',
  PRIMARY KEY (`id`),
  KEY `start_date` (`start_date`),
  KEY `end_date` (`end_date`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COMMENT='互动投屏广告表';

CREATE TABLE `savor_forscreen_ads_box` (
  `id` int(12) NOT NULL AUTO_INCREMENT COMMENT '主键Id',
  `forscreen_ads_id` int(12) NOT NULL DEFAULT '0' COMMENT 'forscreen_ads表主键id',
  `box_id` int(12) NOT NULL DEFAULT '0' COMMENT '机顶盒ID',
  `create_time` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
  `update_time` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '更新时间',
  `down_state` tinyint(1) NOT NULL DEFAULT '0' COMMENT '机顶盒下载状态',
  PRIMARY KEY (`id`),
  KEY `box_id` (`box_id`),
  KEY `foradsid` (`forscreen_ads_id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COMMENT='互动投屏广告对应机顶盒表';

CREATE TABLE `savor_forscreen_ads_hotel` (
  `id` int(12) NOT NULL AUTO_INCREMENT COMMENT '主键Id',
  `forscreen_ads_id` int(12) NOT NULL DEFAULT '0' COMMENT 'pub_ads表主键id',
  `hotel_id` int(12) NOT NULL DEFAULT '0' COMMENT '酒楼id',
  PRIMARY KEY (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COMMENT='互动投屏广告对应酒楼';

增加说明：新增互动广告
修改时间：2019-04-03 09:55
修改人：刘斌
执行SQL：
CREATE TABLE `savor_category` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `name` varchar(50) NOT NULL DEFAULT '' COMMENT '名称',
  `parent_id` int(11) NOT NULL DEFAULT '0' COMMENT '父类id',
  `trees` varchar(100) NOT NULL DEFAULT '' COMMENT '分类树',
  `level` tinyint(1) NOT NULL DEFAULT '0' COMMENT '分类等级0无1一级2二级等',
  `sort` int(11) NOT NULL DEFAULT '0' COMMENT '排序值',
  `status` tinyint(1) NOT NULL DEFAULT '1' COMMENT '状态1启用2禁用',
  `add_time` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '添加时间',
  PRIMARY KEY (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COMMENT='分类表';
ALTER TABLE `cloud`.`savor_smallapp_forscreen_record`
ADD COLUMN `category_id` int(11) NOT NULL DEFAULT '0' COMMENT '分类ID' AFTER `small_app_id`;


ALTER TABLE `cloud`.`savor_category`
ADD COLUMN `type` tinyint(1) NOT NULL DEFAULT 1 COMMENT '类型1内容,2场景' AFTER `sort`;

ALTER TABLE `cloud`.`savor_smallapp_forscreen_record`
ADD COLUMN `scene_id` int(11) NOT NULL DEFAULT 0 COMMENT '场景分类ID' AFTER `category_id`;
ALTER TABLE `cloud`.`savor_smallapp_forscreen_record`
ADD COLUMN `spotstatus` tinyint(1) NOT NULL DEFAULT 0 COMMENT '地点状态' AFTER `category_id`;

ALTER TABLE `cloud`.`savor_category`
MODIFY COLUMN `type` tinyint(1) NOT NULL DEFAULT 1 COMMENT '类型1内容,2场景,3人员属性,4饭局性质,5内容所用软件' AFTER `sort`;

ALTER TABLE `cloud`.`savor_smallapp_forscreen_record`
ADD COLUMN `personattr_id` int(11) NOT NULL DEFAULT 0 COMMENT '人员属性ID(分类表savor_category)' AFTER `scene_id`;
ALTER TABLE `cloud`.`savor_smallapp_forscreen_record`
ADD COLUMN `dinnernature_id` int(11) NOT NULL DEFAULT 0 COMMENT '饭局性质ID(分类表savor_category)' AFTER `scene_id`;
ALTER TABLE `cloud`.`savor_smallapp_forscreen_record`
ADD COLUMN `contentsoft_id` int(11) NOT NULL DEFAULT 0 COMMENT '内容所用软件ID(分类表savor_category)' AFTER `scene_id`;


CREATE TABLE `savor_smallapp_forscreen_invalidrecord` (
  `id` bigint(20) NOT NULL AUTO_INCREMENT,
  `forscreen_id` bigint(20) NOT NULL DEFAULT '0' COMMENT '投屏id',
  `resource_id` bigint(13) NOT NULL DEFAULT '0' COMMENT '资源id',
  `resource_size` int(11) NOT NULL DEFAULT '0' COMMENT '资源大小',
  `openid` varchar(100) NOT NULL DEFAULT '' COMMENT 'openid',
  `box_mac` varchar(20) NOT NULL DEFAULT '' COMMENT '机顶盒mac',
  `action` tinyint(2) NOT NULL DEFAULT '0' COMMENT '1:发送呼码2:投屏视频、图片3:退出投屏4:投多张图5:视频点播',
  `resource_type` tinyint(1) NOT NULL DEFAULT '0' COMMENT '1:图片2:视频',
  `imgs` varchar(500) NOT NULL DEFAULT '' COMMENT '投屏图片',
  `forscreen_char` varchar(50) NOT NULL DEFAULT '' COMMENT '投屏文字',
  `duration` float(10,2) NOT NULL DEFAULT '0.00' COMMENT '时长',
  `mobile_brand` varchar(50) NOT NULL DEFAULT '' COMMENT '手机品牌',
  `mobile_model` varchar(50) NOT NULL DEFAULT '' COMMENT '手机型号',
  `is_pub_hotelinfo` tinyint(1) NOT NULL DEFAULT '0' COMMENT '是否公开酒楼信息0:不公开1:公开',
  `is_share` tinyint(1) NOT NULL DEFAULT '0' COMMENT '是否分享到发现0:不分享1:分享',
  `create_time` datetime DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
  `res_sup_time` bigint(13) NOT NULL DEFAULT '0' COMMENT '资源开始长传时间',
  `res_eup_time` bigint(13) NOT NULL DEFAULT '0' COMMENT '资源上传成功时间',
  `box_res_sdown_time` bigint(13) NOT NULL DEFAULT '0' COMMENT '机顶盒开始下载资源时间',
  `box_res_edown_time` bigint(13) NOT NULL DEFAULT '0' COMMENT '机顶盒下载资源完成时间',
  `is_break` tinyint(1) NOT NULL DEFAULT '0' COMMENT '是否打断',
  `is_exist` tinyint(1) NOT NULL DEFAULT '3' COMMENT '状态0不存在1已存在2下载失败',
  `is_valid` tinyint(1) NOT NULL DEFAULT '1' COMMENT '是否有效1有效 0无效',
  `update_time` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '更新时间',
  `small_app_id` tinyint(2) NOT NULL DEFAULT '1' COMMENT '小程序id1:热点投屏标准版2:热点投屏极简版',
  PRIMARY KEY (`id`),
  KEY `index_box_mac` (`box_mac`),
  KEY `lhindex` (`resource_id`,`openid`),
  KEY `index_create_time` (`create_time`),
  KEY `index_openid` (`openid`) USING BTREE,
  KEY `index_isvalid` (`is_valid`) USING BTREE
) ENGINE=InnoDB DEFAULT CHARSET=utf8;

CREATE TABLE `savor_smallapp_adsposition` (
  `id` bigint(20) NOT NULL AUTO_INCREMENT,
  `name` varchar(20) NOT NULL DEFAULT '' COMMENT '名称',
  `media_id` int(11) NOT NULL DEFAULT '0' COMMENT '资源id',
  `linkcontent` varchar(200) NOT NULL DEFAULT '' COMMENT '链接地址',
  `clicktype` tinyint(1) NOT NULL DEFAULT '1' COMMENT '点击类型1链接,2事件',
  `bindtap` varchar(50) NOT NULL DEFAULT '' COMMENT '绑定事件',
  `appid` varchar(50) NOT NULL DEFAULT '' COMMENT '小程序appid',
  `type` tinyint(1) NOT NULL DEFAULT '1' COMMENT '广告位类型1图片,2视频',
  `position` tinyint(1) NOT NULL DEFAULT '0' COMMENT '广告位位置1首页顶部,2互动页顶部',
  `sort` int(11) NOT NULL DEFAULT '0' COMMENT '排序',
  `status` tinyint(1) NOT NULL DEFAULT '0' COMMENT '0:删除1:正常',
  `create_time` datetime DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
  PRIMARY KEY (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COMMENT='广告位表';

ALTER TABLE `cloud`.`savor_pub_poly_ads`
ADD COLUMN `type` tinyint(1) NOT NULL DEFAULT 1 COMMENT '类型1视频广告 2图片广告' AFTER `creator_id`;

CREATE TABLE `savor_smallapp_redpacketoperation` (
  `id` bigint(16) NOT NULL AUTO_INCREMENT,
  `total_fee` decimal(10,2) NOT NULL DEFAULT '0.00' COMMENT '总金额',
  `amount` int(11) unsigned NOT NULL DEFAULT '0' COMMENT '红包个数',
  `scope` tinyint(1) NOT NULL DEFAULT '1' COMMENT '发送范围 1全网餐厅电视,2当前餐厅所有电视,3当前包间电视',
  `mac` varchar(12) NOT NULL DEFAULT '' COMMENT 'mac地址',
  `type` tinyint(1) NOT NULL DEFAULT '1' COMMENT '类型 1立即发送,2单次定时,3多次定时',
  `start_date` date DEFAULT NULL COMMENT '开始日期',
  `end_date` date DEFAULT NULL COMMENT '结束日期',
  `timing` time DEFAULT NULL COMMENT '定时精确到分,小时分钟如: 13:00',
  `sender` int(11) NOT NULL DEFAULT '0' COMMENT '发送人',
  `status` tinyint(1) unsigned NOT NULL DEFAULT '0' COMMENT '0:不可用,1:可用',
  `sysuser_id` int(11) NOT NULL DEFAULT '0' COMMENT '创建人',
  `add_time` timestamp NULL DEFAULT CURRENT_TIMESTAMP COMMENT '添加时间',
  PRIMARY KEY (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COMMENT='红包运营表';

CREATE TABLE `savor_smallapp_forscreen_invalidlist` (
  `id` bigint(20) NOT NULL AUTO_INCREMENT,
  `invalidid` varchar(100) NOT NULL DEFAULT '' COMMENT '无效ID',
  `type` tinyint(1) NOT NULL DEFAULT '0' COMMENT '类型 1酒楼id,2微信openid,3机顶盒mac,4红包黑名单用户',
  `create_time` datetime DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
  PRIMARY KEY (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COMMENT='小程序投屏无效名单';

ALTER TABLE `cloud`.`savor_smallapp_forscreen_invalidlist`
MODIFY COLUMN `type` tinyint(1) NOT NULL DEFAULT 0 COMMENT '类型 1酒楼id,2微信openid,3机顶盒mac,4红包黑名单用户' AFTER `invalidid`;

ALTER TABLE `cloud`.`savor_hotel_ext`
ADD COLUMN `contract_expiretime` timestamp NULL DEFAULT NULL COMMENT '合同到期时间' AFTER `hotel_cover_media_id`;

ALTER TABLE `cloud`.`savor_tv` ADD INDEX `key_boxid`(`box_id`);

ALTER TABLE `cloud`.`savor_uploadmgr`
MODIFY COLUMN `shw_savepath` varchar(20) CHARACTER SET utf8 COLLATE utf8_general_ci NOT NULL COMMENT '文件路径' AFTER `shw_title`;

CREATE TABLE `savor_tvchannel` (
  `id` bigint(20) NOT NULL AUTO_INCREMENT,
  `channel_name` varchar(20) NOT NULL DEFAULT '' COMMENT '频道名称',
  `freq` int(11) NOT NULL DEFAULT '0' COMMENT '频点',
  `hotel_id` int(11) NOT NULL DEFAULT '0' COMMENT '酒楼id',
  `raw_number` int(11) NOT NULL DEFAULT '0' COMMENT '原始序号',
  `play_number` int(11) NOT NULL DEFAULT '0' COMMENT '播放序号',
  `is_lock` tinyint(1) NOT NULL DEFAULT '0' COMMENT '是否锁定',
  `type` tinyint(1) NOT NULL DEFAULT '0' COMMENT '2二代盒子,3三代盒子',
  `create_time` datetime DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
  PRIMARY KEY (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COMMENT='电视频道表';

CREATE TABLE `savor_tvchannel_ext` (
  `id` bigint(20) NOT NULL AUTO_INCREMENT,
  `tvchannel_id` int(11) NOT NULL DEFAULT '0' COMMENT '电视频道ID',
  `video_standard` int(11) NOT NULL DEFAULT '0' COMMENT '电视默认数据视频标准',
  `audio_standard` int(11) NOT NULL DEFAULT '0' COMMENT '电视默认数据音频标准',
  `display_name` varchar(255) NOT NULL DEFAULT '' COMMENT '电视默认数据显示名称',
  `display_number` varchar(255) NOT NULL DEFAULT '' COMMENT '电视默认数据显示序号',
  `input_id` varchar(255) NOT NULL DEFAULT '' COMMENT '电视默认数据id',
  `is_browsable` varchar(255) NOT NULL DEFAULT '' COMMENT '电视默认数据',
  `provider_data` text COMMENT '电视默认数据',
  `service_id` varchar(255) NOT NULL DEFAULT '' COMMENT '电视默认数据',
  `service_type` varchar(255) NOT NULL DEFAULT '' COMMENT '电视默认数据',
  `type` varchar(255) NOT NULL DEFAULT '' COMMENT '电视默认数据',
  `create_time` datetime DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
  PRIMARY KEY (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COMMENT='电视频道扩展表';

CREATE TABLE `savor_urlmap` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `name` varchar(100) NOT NULL DEFAULT '' COMMENT '名称',
  `link` varchar(255) NOT NULL DEFAULT '' COMMENT 'URL地址',
  `add_time` datetime DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
  PRIMARY KEY (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COMMENT='URL映射表';

CREATE TABLE `savor_qrscan_record` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `urlmap_id` int(11) NOT NULL DEFAULT '0' COMMENT 'URL映射ID',
  `mobile_os` varchar(50) NOT NULL DEFAULT '' COMMENT '手机系统',
  `mobile_brand` varchar(100) NOT NULL DEFAULT '' COMMENT '手机品牌',
  `mobile_model` varchar(100) NOT NULL DEFAULT '' COMMENT '手机型号',
  `user_agent` varchar(500) NOT NULL DEFAULT '' COMMENT 'UA',
  `ip` varchar(50) NOT NULL DEFAULT '' COMMENT '访问IP',
  `add_time` datetime DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
  PRIMARY KEY (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COMMENT='二维码扫描记录表';

ALTER TABLE `cloud`.`savor_smallapp_forscreen_record`
ADD COLUMN `resource_name` varchar(255) NOT NULL DEFAULT '' AFTER `box_res_edown_time`;
ALTER TABLE `cloud`.`savor_smallapp_forscreen_record`
ADD COLUMN `md5_file` char(32) NOT NULL DEFAULT '' AFTER `resource_name`;
ALTER TABLE `cloud`.`savor_smallapp_forscreen_record`
ADD COLUMN `save_type` tinyint(1) NOT NULL DEFAULT 0 COMMENT '文件投屏保存类型 0未知,1阅后即焚,2本地保存' AFTER `md5_file`;
ALTER TABLE `cloud`.`savor_smallapp_forscreen_record`
ADD COLUMN `file_conversion_status` tinyint(1) NOT NULL DEFAULT 0 COMMENT '文件转换状态 0未转换 1转换成功' AFTER `save_type`;

增加说明：新增互动广告
修改时间：2019-07-15 15:00
修改人：张英涛
执行SQL
ALTER TABLE savor_media ADD COLUMN `oss_filesize` INT(11) NOT NULL DEFAULT 0 COMMENT '文件大小单位:字节' AFTER `file_path`
ALTER TABLE savor_device_version ADD COLUMN `oss_filesize` INT(11) NOT NULL DEFAULT 0 COMMENT '文件大小单位:字节' AFTER  `oss_addr`

增加说明：新增活动商品购买 销售工具
修改时间：2019-07-25 13:00
修改人：刘斌
执行SQL

INSERT INTO `cloud`.`savor_sys_config`(`config_key`, `config_value`, `status`) VALUES ('activity_adv_playtype', '1',1);
INSERT INTO `cloud`.`savor_sys_config`(`config_key`, `config_value`, `status`) VALUES ('activity_boot_integral', '0',1);
INSERT INTO `cloud`.`savor_sys_config`(`config_key`, `config_value`, `status`) VALUES ('activity_interact_integral', '0',1);

ALTER TABLE `cloud`.`savor_hotel_ext`
ADD COLUMN `activity_contact` varchar(100) NOT NULL DEFAULT '' COMMENT '活动联系人' AFTER `contract_expiretime`,
ADD COLUMN `activity_phone` varchar(20) NOT NULL DEFAULT '' COMMENT '活动联系人手机号码' AFTER `activity_contact`;

DROP TABLE IF EXISTS `savor_smallapp_user_signin`;
CREATE TABLE `savor_smallapp_user_signin` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `openid` varchar(100) NOT NULL DEFAULT '' COMMENT 'openid',
  `box_mac` varchar(15) NOT NULL DEFAULT '' COMMENT '机顶盒mac',
  `signin_time` timestamp NOT NULL DEFAULT '0000-00-00 00:00:00' COMMENT '签到时间',
  `signout_time` timestamp NOT NULL DEFAULT '0000-00-00 00:00:00' COMMENT '签出时间',
  `add_time` datetime DEFAULT CURRENT_TIMESTAMP COMMENT '添加时间',
  PRIMARY KEY (`id`),
  KEY `index_box_mac` (`box_mac`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COMMENT='用户签到表';

DROP TABLE IF EXISTS `savor_smallapp_user_integral`;
CREATE TABLE `savor_smallapp_user_integral` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `openid` varchar(100) NOT NULL DEFAULT '' COMMENT 'openid',
  `integral` int(11) NOT NULL DEFAULT '0' COMMENT '积分',
  `update_time` timestamp NOT NULL DEFAULT '0000-00-00 00:00:00' COMMENT '更新时间',
  `add_time` datetime DEFAULT CURRENT_TIMESTAMP COMMENT '添加时间',
  PRIMARY KEY (`id`),
  KEY `index_openid` (`openid`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COMMENT='用户积分表';

DROP TABLE IF EXISTS `savor_smallapp_user_integralrecord`;
CREATE TABLE `savor_smallapp_user_integralrecord` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `openid` varchar(100) NOT NULL DEFAULT '' COMMENT 'openid',
  `area_id` int(11) NOT NULL DEFAULT '0' COMMENT '区域id',
  `area_name` varchar(10) NOT NULL DEFAULT '' COMMENT '区域名称',
  `hotel_id` int(11) NOT NULL DEFAULT '0' COMMENT '酒楼id',
  `hotel_name` varchar(100) NOT NULL DEFAULT '' COMMENT '酒楼名称',
  `hotel_box_type` tinyint(1) NOT NULL DEFAULT '0' COMMENT '酒楼盒子类型',
  `room_id` int(11) NOT NULL DEFAULT '0' COMMENT '包间id',
  `room_name` varchar(100) NOT NULL DEFAULT '' COMMENT '包间名称',
  `box_id` int(11) NOT NULL DEFAULT '0' COMMENT '机顶盒id',
  `box_mac` varchar(15) NOT NULL DEFAULT '' COMMENT '机顶盒mac',
  `box_type` tinyint(1) NOT NULL DEFAULT '0' COMMENT '包间类型',
  `integral` int(11) NOT NULL DEFAULT '0' COMMENT '积分',
  `content` varchar(255) NOT NULL DEFAULT '' COMMENT '积分内容',
  `type` tinyint(1) NOT NULL DEFAULT '0' COMMENT '积分类型 1开机,2互动,3销售,4兑换',
  `integral_time` timestamp NOT NULL DEFAULT '0000-00-00 00:00:00' COMMENT '积分时间',
  `add_time` datetime DEFAULT CURRENT_TIMESTAMP COMMENT '添加时间',
  PRIMARY KEY (`id`),
  KEY `index_box_mac` (`box_mac`),
  KEY `index_openid` (`openid`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COMMENT='用户积分记录表';

DROP TABLE IF EXISTS `savor_smallapp_goods`;
CREATE TABLE `savor_smallapp_goods` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `name` varchar(200) NOT NULL DEFAULT '' COMMENT '名称',
  `media_id` int(11) NOT NULL DEFAULT '0' COMMENT '资源ID',
  `imgmedia_id` int(11) NOT NULL DEFAULT '0' COMMENT '图片资源ID',
  `price` decimal(9,2) NOT NULL DEFAULT '0.00' COMMENT '价格',
  `rebate_integral` int(11) NOT NULL DEFAULT '0' COMMENT '返利积分',
  `jd_url` varchar(200) NOT NULL DEFAULT '' COMMENT '京东商品URL链接',
  `type` tinyint(1) NOT NULL DEFAULT '0' COMMENT '类型 10官方活动促销,20商家添加,30积分兑换现金',
  `start_time` timestamp NOT NULL DEFAULT '0000-00-00 00:00:00' COMMENT '开始时间',
  `end_time` timestamp NOT NULL DEFAULT '0000-00-00 00:00:00' COMMENT '结束时间',
  `scope` tinyint(1) NOT NULL DEFAULT '0' COMMENT '活动范围0全部,1包间,2非包间',
  `status` tinyint(1) NOT NULL DEFAULT '0' COMMENT '状态1未审核,2审核通过,3审核不通过,4下架,5已过期',
  `add_time` datetime DEFAULT CURRENT_TIMESTAMP COMMENT '添加时间',
  PRIMARY KEY (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COMMENT='商品表';

DROP TABLE IF EXISTS `savor_smallapp_hotelgoods`;
CREATE TABLE `savor_smallapp_hotelgoods` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `hotel_id` int(11) NOT NULL DEFAULT '0' COMMENT '酒楼ID',
  `openid` varchar(100) NOT NULL DEFAULT '' COMMENT '用户openid',
  `goods_id` int(11) NOT NULL DEFAULT '0' COMMENT 'ID',
  `add_time` datetime DEFAULT CURRENT_TIMESTAMP COMMENT '添加时间',
  PRIMARY KEY (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COMMENT='酒楼商品表';

DROP TABLE IF EXISTS `savor_smallapp_order`;
CREATE TABLE `savor_smallapp_order` (
  `id` bigint(20) NOT NULL AUTO_INCREMENT,
  `openid` varchar(100) NOT NULL DEFAULT '' COMMENT '用户openid',
  `box_mac` varchar(15) NOT NULL DEFAULT '' COMMENT '购买所在的机顶盒mac',
  `goods_id` int(11) NOT NULL DEFAULT '0' COMMENT '商品ID',
  `price` decimal(9,2) NOT NULL DEFAULT '0.00' COMMENT '商品价格',
  `amount` int(11) NOT NULL DEFAULT '0' COMMENT '购买数量',
  `total_fee` decimal(10,2) NOT NULL DEFAULT '0.00' COMMENT '总金额',
  `status` tinyint(1) NOT NULL DEFAULT '0' COMMENT '10已下单,20申请兑换,21兑换成功',
  `otype` tinyint(1) NOT NULL DEFAULT '0' COMMENT '订单类型1商品订单2抵用券订单',
  `buy_type` tinyint(1) NOT NULL DEFAULT '0' COMMENT '购买类型1店内购买 2京东购买',
  `add_time` datetime DEFAULT CURRENT_TIMESTAMP COMMENT '添加时间',
  PRIMARY KEY (`id`)
) ENGINE=InnoDB AUTO_INCREMENT=1000000 DEFAULT CHARSET=utf8 COMMENT='订单信息表';

DROP TABLE IF EXISTS `savor_smallapp_goodscollection`;
CREATE TABLE `savor_smallapp_goodscollection` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `openid` varchar(100) NOT NULL DEFAULT '' COMMENT '用户openid',
  `goods_id` int(11) NOT NULL DEFAULT '0' COMMENT '商品ID',
  `phone` varchar(20) NOT NULL DEFAULT '' COMMENT '手机号码',
  `add_time` datetime DEFAULT CURRENT_TIMESTAMP COMMENT '添加时间',
  PRIMARY KEY (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COMMENT='商品收藏表';

增加说明：新增好友助力上电视功能
修改时间：2019-08-18 09:00
修改人：刘斌
执行SQL
ALTER TABLE `cloud`.`savor_smallapp_play_log`
MODIFY COLUMN `type` tinyint(1) NOT NULL DEFAULT 0 COMMENT '1:点播2:投屏3:节目单资源4精选内容' AFTER `res_id`;

ALTER TABLE `cloud`.`savor_smallapp_forscreen_record`
ADD INDEX `index_forscreen_id`(`forscreen_id`);
INSERT INTO `cloud`.`savor_sys_config`(`config_key`, `config_value`, `status`) VALUES ('content_play_time', '120', '1')

CREATE TABLE `savor_smallapp_forscreen_help` (
  `id` bigint(20) NOT NULL AUTO_INCREMENT,
  `forscreen_record_id` bigint(20) NOT NULL DEFAULT '0' COMMENT '投屏记录id',
  `openid` varchar(100) NOT NULL DEFAULT '' COMMENT 'openid',
  `status` tinyint(1) NOT NULL DEFAULT '0' COMMENT '播放状态 1未播放,2待播放,3播放中,4播放完成',
  `add_time` datetime DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
  PRIMARY KEY (`id`),
  KEY `key_openrecord` (`openid`,`forscreen_record_id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COMMENT='小程序投屏助力表';

CREATE TABLE `savor_smallapp_forscreen_helpuser` (
  `id` bigint(20) NOT NULL AUTO_INCREMENT,
  `help_id` bigint(20) NOT NULL DEFAULT '0' COMMENT '助力播放id',
  `openid` varchar(100) NOT NULL DEFAULT '' COMMENT 'openid',
  `add_time` datetime DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
  PRIMARY KEY (`id`),
  KEY `key_helpid` (`help_id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COMMENT='小程序投屏助力用户表';

增加说明：优化餐厅端登录方式更改为扫码登录，红包未发送完毕进行发送完毕
修改时间：2019-09-02 11:00
修改人：刘斌
执行SQL
ALTER TABLE `cloud`.`savor_hotel_invite_code`
ADD COLUMN `openid` varchar(100) NOT NULL DEFAULT '' COMMENT '绑定用户openid' AFTER `bind_time`;

ALTER TABLE `cloud`.`savor_hotel_invite_code`
ADD COLUMN `type` tinyint(1) NOT NULL DEFAULT 1 COMMENT '类型1普通码 2管理员码' AFTER `openid`;

ALTER TABLE `cloud`.`savor_hotel_invite_code`
ADD COLUMN `invite_id` int(11) NOT NULL DEFAULT 0 COMMENT '邀请ID即表savor_hotel_invite_code中id' AFTER `type`;

ALTER TABLE `cloud`.`savor_smallapp_redpacket`
ADD COLUMN `operate_type` tinyint(1) NOT NULL DEFAULT 0 COMMENT '操作类型 0正常,1人工' AFTER `isdel`;

ALTER TABLE `cloud`.`savor_smallapp_redpacket_receive`
ADD COLUMN `operate_type` tinyint(1) NOT NULL DEFAULT 0 COMMENT '操作类型 0正常,1人工' AFTER `receive_time`;

ALTER TABLE `cloud`.`savor_hotel_ext`
ADD COLUMN `is_open_integral` tinyint(1) NOT NULL DEFAULT 0 COMMENT '是否开启积分兑换' AFTER `is_open_customer`;

增加说明：增加精选商品内容，公开置顶
修改时间：2019-09-05 10:00
修改人：刘斌
执行SQL
ALTER TABLE `cloud`.`savor_smallapp_goods`
ADD COLUMN `appid` varchar(50) NOT NULL DEFAULT '' COMMENT '小程序appid' AFTER `jd_url`;
ALTER TABLE `cloud`.`savor_smallapp_goods`
ADD COLUMN `buybutton` varchar(50) NOT NULL DEFAULT '' COMMENT '购买按钮' AFTER `appid`;
ALTER TABLE `cloud`.`savor_smallapp_collect`
MODIFY COLUMN `type` tinyint(1) NOT NULL DEFAULT 0 COMMENT '1:点播2:投屏3:节目单资源4:商品' AFTER `openid`;
ALTER TABLE `cloud`.`savor_smallapp_public`
ADD COLUMN `is_top` tinyint(1) NOT NULL DEFAULT 0 COMMENT '是否置顶 1置顶' AFTER `is_recommend`;
ALTER TABLE `cloud`.`savor_smallapp_public`
ADD INDEX `index_staretop`(`status`, `is_recommend`, `is_top`);
CREATE TABLE `savor_smallapp_datalog` (
  `id` bigint(20) NOT NULL AUTO_INCREMENT,
  `data_id` int(11) NOT NULL DEFAULT '0' COMMENT '数据id',
  `name` varchar(50) NOT NULL DEFAULT '' COMMENT '名称',
  `openid` varchar(100) NOT NULL DEFAULT '' COMMENT 'openid',
  `action_type` tinyint(1) NOT NULL DEFAULT '0' COMMENT '动作类型1点击,2查看,3点击购买',
  `type` tinyint(1) NOT NULL DEFAULT '0' COMMENT '类型 1广告,2商品',
  `ip` varchar(50) NOT NULL DEFAULT '' COMMENT '访问IP',
  `add_time` datetime DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
  PRIMARY KEY (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COMMENT='数据日志表';

增加说明：增加商品字段,微信好物圈开发，京东订单开发
修改时间：2019-09-19 17:00
修改人：刘斌
执行SQL
ALTER TABLE `cloud`.`savor_smallapp_goods`
ADD COLUMN `page_url` varchar(500) NOT NULL DEFAULT '' COMMENT '小程序页面URL地址' AFTER `buybutton`;
ALTER TABLE `cloud`.`savor_smallapp_goods`
ADD COLUMN `wx_category` varchar(200) NOT NULL DEFAULT '' COMMENT '微信好物圈类目' AFTER `name`;
ALTER TABLE `cloud`.`savor_smallapp_goods`
ADD COLUMN `item_id` varchar(50) NOT NULL DEFAULT '' COMMENT '第三方商品ID' AFTER `jd_url`;
ALTER TABLE `cloud`.`savor_smallapp_goods`
MODIFY COLUMN `type` tinyint(1) NOT NULL DEFAULT 0 COMMENT '类型 10官方活动促销,20商家添加,30积分兑换现金,31积分兑换物品,40热点优选' AFTER `page_url`;
ALTER TABLE `cloud`.`savor_smallapp_hotelgoods`
ADD COLUMN `type` tinyint(1) NOT NULL DEFAULT 1 COMMENT '类型1系统添加 2用户销售添加' AFTER `goods_id`;
ALTER TABLE `cloud`.`savor_smallapp_user_integralrecord`
ADD COLUMN `goods_id` int(11) NOT NULL DEFAULT 0 COMMENT '商品ID' AFTER `integral`;
ALTER TABLE `cloud`.`savor_smallapp_user_integralrecord`
ADD COLUMN `jdorder_id` int(11) NOT NULL DEFAULT 0 COMMENT '京东订单ID' AFTER `goods_id`;
ALTER TABLE `cloud`.`savor_smallapp_user_integralrecord`
ADD INDEX `index_jdoid`(`jdorder_id`);
ALTER TABLE `cloud`.`savor_smallapp_user_integralrecord`
ADD COLUMN `status` tinyint(1) NOT NULL DEFAULT 1 COMMENT '状态 1可用2未结算不可用' AFTER `content`;
ALTER TABLE `cloud`.`savor_smallapp_order`
ADD COLUMN `contact` varchar(30) NOT NULL DEFAULT '' COMMENT '联系人' AFTER `buy_type`,
ADD COLUMN `phone` char(13) NOT NULL DEFAULT '' COMMENT '联系电话' AFTER `contact`,
ADD COLUMN `address` varchar(200) NOT NULL DEFAULT '' COMMENT '地址' AFTER `phone`;
CREATE TABLE `savor_smallapp_jdorder` (
  `id` bigint(20) NOT NULL AUTO_INCREMENT,
  `order_id` varchar(50) NOT NULL DEFAULT '' COMMENT '订单ID',
  `order_time` int(11) NOT NULL DEFAULT '0' COMMENT '下单时间',
  `finish_time` int(11) NOT NULL DEFAULT '0' COMMENT '订单完成时间',
  `order_emt` int(11) NOT NULL DEFAULT '0' COMMENT '下单设备(1:PC,2:无线)',
  `parent_id` varchar(50) NOT NULL DEFAULT '' COMMENT '父单的订单ID',
  `pay_month` int(11) NOT NULL DEFAULT '0' COMMENT '订单维度预估结算时间',
  `plus` int(11) NOT NULL DEFAULT '0' COMMENT '下单用户是否为PLUS会员 0：否，1：是',
  `pop_id` varchar(50) NOT NULL DEFAULT '' COMMENT '商家ID',
  `actual_cos_price` decimal(9,2) NOT NULL DEFAULT '0.00' COMMENT '实际计算佣金的金额',
  `actual_fee` decimal(9,2) NOT NULL DEFAULT '0.00' COMMENT '推客获得的实际佣金',
  `commissionrate` decimal(9,2) NOT NULL DEFAULT '0.00' COMMENT '佣金比例',
  `estimate_cos_price` decimal(9,2) NOT NULL DEFAULT '0.00' COMMENT '预估计佣金额，即用户下单的金额',
  `estimate_fee` decimal(9,2) NOT NULL DEFAULT '0.00' COMMENT '推客的预估佣金',
  `final_rate` decimal(9,2) NOT NULL DEFAULT '0.00' COMMENT '最终比例（分成比例+补贴比例）',
  `pid` varchar(50) NOT NULL DEFAULT '' COMMENT '联盟子站长身份标识',
  `price` decimal(9,2) NOT NULL DEFAULT '0.00' COMMENT '商品单价',
  `sku_id` varchar(50) NOT NULL DEFAULT '' COMMENT '商品ID',
  `sku_name` varchar(200) NOT NULL DEFAULT '' COMMENT '商品名称',
  `sku_num` int(11) NOT NULL DEFAULT '0' COMMENT '商品数量',
  `sku_return_num` int(11) NOT NULL DEFAULT '0' COMMENT '商品已退货数量',
  `sub_side_rate` int(11) NOT NULL DEFAULT '0' COMMENT '分成比例',
  `subsidy_rate` int(11) NOT NULL DEFAULT '0' COMMENT '补贴比例',
  `union_alias` varchar(50) NOT NULL DEFAULT '' COMMENT 'PID所属母账号平台名称',
  `union_tag` varchar(50) NOT NULL DEFAULT '' COMMENT '联盟标签数据',
  `union_traffic_group` int(11) NOT NULL DEFAULT '0' COMMENT '渠道组 1：1号店，其他：京东',
  `valid_code` int(11) NOT NULL DEFAULT '0' COMMENT 'sku维度的有效码（-1：未知,2.无效-拆单,3.无效-取消,4.无效-京东帮帮主订单,5.无效-账号异常,6.无效-赠品类目不返佣,7.无效-校园订单,8.无效-企业订单,9.无效-团购订单,10.无效-开增值税专用发票订单,11.无效-乡村推广员下单,12.无效-自己推广自己下单,13.无效-违规订单,14.无效-来源与备案网址不符,15.待付款,16.已付款,17.已完成,18.已结算',
  `sub_union_id` int(11) NOT NULL DEFAULT '0' COMMENT '销售人员用户ID',
  `trace_type` int(11) NOT NULL DEFAULT '0' COMMENT '2：同店；3：跨店',
  `cp_act_id` varchar(50) NOT NULL DEFAULT '' COMMENT '招商团活动id，正整数，为0时表示无活动',
  `union_role` int(11) NOT NULL DEFAULT '0' COMMENT '站长角色，1： 推客、 2： 团长',
  `union_id` varchar(50) NOT NULL DEFAULT '' COMMENT '推客的联盟ID',
  `update_time` timestamp NOT NULL DEFAULT '0000-00-00 00:00:00' COMMENT '更新时间',
  `add_time` datetime DEFAULT CURRENT_TIMESTAMP COMMENT '添加时间',
  PRIMARY KEY (`id`),
  KEY `key_orderid` (`order_id`),
  KEY `key_subuidvcode` (`sub_union_id`,`valid_code`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COMMENT='京东订单信息表';

增加说明：增加店内购买
修改时间：2019-10-18 13:00
修改人：刘斌
执行SQL
ALTER TABLE `cloud`.`savor_smallapp_goods`
MODIFY COLUMN `type` tinyint(1) NOT NULL DEFAULT 0 COMMENT '类型 10热点优选,20商家添加,30积分兑换现金,31积分兑换物品' AFTER `page_url`;

ALTER TABLE `cloud`.`savor_smallapp_goods`
ADD COLUMN `is_storebuy` tinyint(0) NOT NULL DEFAULT 0 COMMENT '是否店内购买1是 0否' AFTER `scope`;

ALTER TABLE `cloud`.`savor_hotel_invite_code`
MODIFY COLUMN `type` tinyint(1) NOT NULL DEFAULT 1 COMMENT '类型1普通码,2管理员码,3通用邀请码' AFTER `openid`;

ALTER TABLE `cloud`.`savor_smallapp_datalog`
MODIFY COLUMN `type` tinyint(1) NOT NULL DEFAULT 0 COMMENT '类型 1广告,2商品,3发现-官方,4发现-精选,5发现-公开' AFTER `action_type`;

ALTER TABLE `cloud`.`savor_smallapp_hotelgoods`
ADD INDEX `key_hotelid`(`hotel_id`);

UPDATE `cloud`.`savor_smallapp_goods` SET `type` = 10 WHERE `type` = 40;

增加说明：增加扫码支付,开发票
修改时间：2019-10-25 13:00
修改人：刘斌
执行SQL
ALTER TABLE `cloud`.`savor_smallapp_order`
ADD COLUMN `pay_time` datetime(0) NOT NULL DEFAULT '0000-00-00 00:00:00' COMMENT '支付时间' AFTER `address`;
ALTER TABLE `cloud`.`savor_smallapp_order`
ADD COLUMN `pay_fee` decimal(10, 2) NOT NULL DEFAULT 0.00 COMMENT '支付金额' AFTER `total_fee`,
ADD COLUMN `pay_type` int(5) NOT NULL DEFAULT 0 COMMENT '支付类型0未知 10微信支付' AFTER `pay_time`;

ALTER TABLE `cloud`.`savor_smallapp_order`
MODIFY COLUMN `status` tinyint(1) NOT NULL DEFAULT 0 COMMENT '10已下单 11支付失败 12支付成功' AFTER `pay_fee`;

ALTER TABLE `cloud`.`savor_smallapp_order`
ADD COLUMN `sale_uid` int(11) NOT NULL DEFAULT 0 COMMENT '销售人员用户ID' AFTER `pay_type`;

ALTER TABLE savor_ads ADD COLUMN `is_sapp_show` TINYINT(1) NOT NULL DEFAULT 1 COMMENT '小程序发现页内容';

CREATE TABLE `savor_smallapp_orderinvoice` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `order_id` bigint(20) NOT NULL DEFAULT '0' COMMENT '订单号',
  `status` tinyint(1) NOT NULL DEFAULT '0' COMMENT '1暂不开票 2已提交开具发票申请 3待开发票 4发票已开',
  `type` tinyint(1) NOT NULL DEFAULT '0' COMMENT '发票类型1纸质发票 2电子发票',
  `contact` varchar(30) NOT NULL DEFAULT '' COMMENT '联系人',
  `phone` char(13) NOT NULL DEFAULT '' COMMENT '联系电话',
  `address` varchar(200) NOT NULL DEFAULT '' COMMENT '地址',
  `email` varchar(30) NOT NULL DEFAULT '' COMMENT '邮箱地址',
  `invoice_addr` varchar(100) NOT NULL DEFAULT '' COMMENT '发票地址',
  `update_time` datetime NOT NULL DEFAULT '0000-00-00 00:00:00' COMMENT '更新时间',
  `add_time` datetime DEFAULT CURRENT_TIMESTAMP COMMENT '添加时间',
  PRIMARY KEY (`id`),
  KEY `key_orderid` (`order_id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COMMENT='订单发票信息表';

CREATE TABLE `savor_smallapp_exchange` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `openid` varchar(100) NOT NULL DEFAULT '' COMMENT '用户openid',
  `box_mac` varchar(15) NOT NULL DEFAULT '' COMMENT '购买所在的机顶盒mac',
  `goods_id` int(11) NOT NULL DEFAULT '0' COMMENT '商品ID',
  `price` decimal(9,2) NOT NULL DEFAULT '0.00' COMMENT '商品价格',
  `amount` int(11) NOT NULL DEFAULT '0' COMMENT '数量',
  `total_fee` decimal(10,2) NOT NULL DEFAULT '0.00' COMMENT '总金额',
  `status` tinyint(1) NOT NULL DEFAULT '0' COMMENT '20申请兑换,21兑换成功',
  `contact` varchar(30) NOT NULL DEFAULT '' COMMENT '联系人',
  `phone` char(13) NOT NULL DEFAULT '' COMMENT '联系电话',
  `address` varchar(200) NOT NULL DEFAULT '' COMMENT '地址',
  `add_time` datetime DEFAULT CURRENT_TIMESTAMP COMMENT '添加时间',
  PRIMARY KEY (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COMMENT='兑换信息表';


增加说明：增加积分系统
修改时间：2019-10-25 13:00
修改人：刘斌
执行SQL
ALTER TABLE `cloud`.`savor_smallapp_redpacket`
ADD COLUMN `rate` decimal(2, 2) NOT NULL DEFAULT 0.00 COMMENT '费率' AFTER `scope`;

ALTER TABLE `cloud`.`savor_smallapp_redpacket`
ADD COLUMN `rate_fee` decimal(10, 2) NOT NULL DEFAULT 0.00 COMMENT '费率金额' AFTER `pay_fee`;

INSERT INTO `cloud`.`savor_sys_config`(`config_key`, `config_value`, `status`) VALUES ('integral_exchange_rate', '0', 1);
INSERT INTO `cloud`.`savor_sys_config`(`config_key`, `config_value`, `status`) VALUES ('red_packet_rate', '0.01', 1);


ALTER TABLE `cloud`.`savor_smallapp_user_integralrecord`
ADD COLUMN `source` tinyint(1) NOT NULL DEFAULT 1 COMMENT '来源 1正常订单order 2兑换订单 3京东订单 ' AFTER `type`;

ALTER TABLE `cloud`.`savor_smallapp_user_integralrecord`
MODIFY COLUMN `type` tinyint(1) NOT NULL DEFAULT 0 COMMENT '积分类型 1开机,2互动,3销售,4兑换,5退回' AFTER `status`;

ALTER TABLE `cloud`.`savor_smallapp_user_integralrecord`
ADD COLUMN `fj_type` tinyint(1) NOT NULL DEFAULT 0 COMMENT '饭局类型0无,1午饭,2晚饭' AFTER `integral_time`;

ALTER TABLE `cloud`.`savor_smallapp_user_integralrecord`
ADD COLUMN `task_id` int(11) NOT NULL DEFAULT 0 COMMENT '任务ID' AFTER `box_type`;


ALTER TABLE `cloud`.`savor_smallapp_exchange`
ADD COLUMN `audit_status` tinyint(1) NOT NULL DEFAULT 0 COMMENT '审核状态0无 1审核通过 2审核不通过' AFTER `status`;

ALTER TABLE `cloud`.`savor_smallapp_exchange`
MODIFY COLUMN `sysuser_id` int(11) NOT NULL DEFAULT 0 COMMENT '系统用户ID' AFTER `address`;

ALTER TABLE `cloud`.`savor_smallapp_exchange`
ADD COLUMN `hotel_id` int(11) NOT NULL DEFAULT 0 COMMENT '酒楼ID' AFTER `box_mac`;

ALTER TABLE `cloud`.`savor_smallapp_exchange`
ADD COLUMN `sysuser_id` int(11) NOT NULL COMMENT '系统用户ID' AFTER `address`,
ADD COLUMN `update_time` datetime(0) NOT NULL DEFAULT '0000-00-00 00:00:00' COMMENT '更新时间' AFTER `sysuser_id`;

ALTER TABLE `cloud`.`savor_smallapp_goods`
ADD COLUMN `is_audit` tinyint(1) NOT NULL DEFAULT 0 COMMENT '是否需要审核1是(此状态针对类型为30的商品))' AFTER `is_storebuy`;
ALTER TABLE `cloud`.`savor_smallapp_goods`
ADD COLUMN `sysuser_id` int(11) NOT NULL DEFAULT 0 COMMENT '系统用户ID' AFTER `is_audit`;

CREATE TABLE `savor_integral_merchant` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `hotel_id` int(11) NOT NULL DEFAULT '0' COMMENT '酒楼id',
  `service_model_id` int(11) NOT NULL DEFAULT '0' COMMENT '服务模型ID',
  `channel_id` int(11) NOT NULL DEFAULT '0' COMMENT '渠道商ID 10内购网',
  `rate_groupid` tinyint(1) NOT NULL DEFAULT '0' COMMENT '汇率群组ID',
  `cash_rate` decimal(10,2) NOT NULL DEFAULT '0.00' COMMENT '兑现汇率',
  `recharge_rate` decimal(10,2) NOT NULL DEFAULT '0.00' COMMENT '充值汇率',
  `name` varchar(20) NOT NULL DEFAULT '' COMMENT '姓名',
  `job` varchar(20) NOT NULL DEFAULT '' COMMENT '职务',
  `code` varchar(20) NOT NULL DEFAULT '' COMMENT '邀请码',
  `mobile` varchar(15) NOT NULL DEFAULT '' COMMENT '手机号码',
  `type` tinyint(1) NOT NULL DEFAULT '2' COMMENT '类型1普通码,2管理员码,3通用邀请码',
  `sysuser_id` int(11) NOT NULL DEFAULT '0' COMMENT '创建、编辑人用户id',
  `status` tinyint(1) NOT NULL DEFAULT '0' COMMENT '状态0未知,1正常,2删除',
  `add_time` datetime DEFAULT CURRENT_TIMESTAMP,
  PRIMARY KEY (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COMMENT='小程序销售端商家';

CREATE TABLE `savor_integral_merchant_staff` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `merchant_id` int(11) NOT NULL DEFAULT '0' COMMENT '商家id',
  `parent_id` int(11) NOT NULL DEFAULT '0' COMMENT '父类id',
  `name` varchar(20) NOT NULL DEFAULT '' COMMENT '姓名',
  `openid` varchar(100) NOT NULL DEFAULT '' COMMENT '绑定用户openid',
  `beinvited_time` datetime NOT NULL DEFAULT '0000-00-00 00:00:00' COMMENT '被邀请时间',
  `trees` varchar(100) NOT NULL DEFAULT '' COMMENT '类目树',
  `level` tinyint(1) NOT NULL DEFAULT '0' COMMENT '等级0无,1一级,2二级,3三级,4级',
  `sysuser_id` int(11) NOT NULL DEFAULT '0' COMMENT '创建、编辑后台用户id',
  `status` tinyint(1) NOT NULL DEFAULT '0' COMMENT '状态0未知,1正常,2删除',
  `add_time` datetime DEFAULT CURRENT_TIMESTAMP COMMENT '添加时间',
  `update_time` datetime DEFAULT CURRENT_TIMESTAMP COMMENT '修改时间',
  PRIMARY KEY (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COMMENT='小程序销售端商家员工';

CREATE TABLE `savor_integral_service` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `name` varchar(50) NOT NULL DEFAULT '' COMMENT '服务名称',
  `m_name` varchar(15) NOT NULL DEFAULT '' COMMENT '模块名称',
  `type` tinyint(1) NOT NULL DEFAULT '1' COMMENT '1:基础服务2:增值服务',
  `desc` text COMMENT '服务说明',
  `create_time` datetime DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
  `update_time` datetime DEFAULT CURRENT_TIMESTAMP COMMENT '更新时间',
  `uid` int(11) NOT NULL DEFAULT '0' COMMENT '创建人用户id',
  `e_uid` int(11) DEFAULT '0' COMMENT '编辑人用户id',
  `status` tinyint(1) NOT NULL DEFAULT '0' COMMENT '0:已删除1:正常',
  PRIMARY KEY (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COMMENT='小程序销售端服务列表';

CREATE TABLE `savor_integral_service_model` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `name` varchar(50) NOT NULL DEFAULT '' COMMENT '服务模型名称',
  `service_ids` varchar(255) NOT NULL DEFAULT '' COMMENT '选择的服务类型id',
  `create_time` datetime DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
  `update_time` datetime DEFAULT CURRENT_TIMESTAMP COMMENT '更新时间',
  `uid` int(11) NOT NULL DEFAULT '0' COMMENT '创建人用户id',
  `e_uid` int(11) DEFAULT '0' COMMENT '编辑人用户id',
  `status` tinyint(1) NOT NULL DEFAULT '0' COMMENT '0:已删除1:正常',
  PRIMARY KEY (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COMMENT='小程序销售端服务模型';

CREATE TABLE `savor_integral_task` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `name` varchar(50) NOT NULL DEFAULT '' COMMENT '任务名称',
  `media_id` int(11) NOT NULL DEFAULT '0' COMMENT '任务封面图id',
  `type` int(11) NOT NULL DEFAULT '0' COMMENT '任务类型1:系统任务2:活动任务',
  `desc` text COMMENT '任务描述',
  `start_time` datetime DEFAULT NULL COMMENT '任务开始时间',
  `end_time` datetime DEFAULT NULL COMMENT '任务开始时间',
  `is_long_time` tinyint(1) NOT NULL DEFAULT '0' COMMENT '是否长期任务',
  `integral` int(11) NOT NULL DEFAULT '0' COMMENT '奖励积分',
  `separate_id` int(11) NOT NULL DEFAULT '0' COMMENT '分成id',
  `task_info` text COMMENT '任务内容(json数据)',
  `create_time` datetime DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
  `update_time` datetime DEFAULT CURRENT_TIMESTAMP COMMENT '更新时间',
  `uid` int(11) NOT NULL DEFAULT '0' COMMENT '创建人用户id',
  `e_uid` int(11) DEFAULT '0' COMMENT '编辑人用户id',
  `status` tinyint(1) NOT NULL DEFAULT '0' COMMENT '0:下线1:上线',
  `flag` tinyint(1) NOT NULL DEFAULT '1' COMMENT '0:删除,1:正常',
  PRIMARY KEY (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COMMENT='任务列表';

CREATE TABLE `savor_integral_task_hotel` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `task_id` int(11) NOT NULL DEFAULT '0' COMMENT '任务id',
  `hotel_id` int(11) NOT NULL DEFAULT '0' COMMENT '酒楼id',
  `uid` int(11) NOT NULL DEFAULT '0' COMMENT '操作人id',
  `create_time` datetime DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
  PRIMARY KEY (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COMMENT='任务针对商家';

CREATE TABLE `savor_integral_task_user` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `openid` varchar(100) NOT NULL DEFAULT '' COMMENT 'openid',
  `task_id` int(11) NOT NULL DEFAULT '0' COMMENT '任务id',
  `integral` int(11) NOT NULL DEFAULT '0' COMMENT '积分',
  `add_time` datetime DEFAULT CURRENT_TIMESTAMP COMMENT '添加时间',
  PRIMARY KEY (`id`),
  KEY `key_openidtime` (`openid`,`add_time`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COMMENT='用户任务表';


增加说明：增加销售活动任务
修改时间：2019-10-28 16:00
修改人：刘斌
执行SQL
ALTER TABLE `cloud`.`savor_smallapp_user_integralrecord`
ADD INDEX `index_type`(`type`);
ALTER TABLE `cloud`.`savor_smallapp_user_integralrecord`
MODIFY COLUMN `type` tinyint(1) NOT NULL DEFAULT 0 COMMENT '积分类型 1开机,2互动,3销售,4兑换,5退回,6活动促销' AFTER `status`;


增加说明：增加销售活动任务，主干版和极简版本合并
修改时间：2019-12-04 15:00
修改人：刘斌
执行SQL
ALTER TABLE `cloud`.`savor_smallapp_goods`
ADD COLUMN `intro` varchar(300) CHARACTER SET utf8 NOT NULL DEFAULT '' COMMENT '简介' AFTER `name`;
ALTER TABLE `cloud`.`savor_smallapp_goods`
ADD COLUMN `label` varchar(100) CHARACTER SET utf8 NOT NULL DEFAULT '' COMMENT '标签' AFTER `intro`;
ALTER TABLE `cloud`.`savor_smallapp_goods`
ADD COLUMN `cover_imgmedia_ids` varchar(255) CHARACTER SET utf8 NOT NULL DEFAULT '' COMMENT '封面图资源ID' AFTER `imgmedia_id`;
ALTER TABLE `cloud`.`savor_smallapp_goods`
ADD COLUMN `show_status` tinyint(1) NOT NULL DEFAULT 0 COMMENT '显示状态 0无 1小程序优选显示' AFTER `sysuser_id`;
ALTER TABLE `cloud`.`savor_smallapp_play_log`
MODIFY COLUMN `type` tinyint(1) NOT NULL DEFAULT 0 COMMENT '1:点播2:投屏3:节目单资源4精选内容5优选商品' AFTER `res_id`;
ALTER TABLE `cloud`.`savor_ads`
ADD COLUMN `portraitmedia_id` bigint(20) NOT NULL DEFAULT 0 COMMENT '竖屏媒体资源id' AFTER `media_id`;
ALTER TABLE `cloud`.`savor_smallapp_collect`
ADD INDEX `index_ridtype`(`res_id`, `type`);
UPDATE `cloud`.`savor_smallapp_goods` SET `show_status` = 1 WHERE `status`=2;

增加说明：销售端增加欢迎词
修改时间：2019-12-09 09:00
修改人：刘斌
执行SQL
ALTER TABLE `cloud`.`savor_category`
MODIFY COLUMN `type` tinyint(1) NOT NULL DEFAULT 1 COMMENT '类型1内容,2场景,3人员属性,4饭局性质,5内容所用软件,6欢迎词背景图分类' AFTER `sort`;
ALTER TABLE `cloud`.`savor_integral_task_user`
ADD INDEX `key_taskid`(`task_id`);
ALTER TABLE `cloud`.`savor_smallapp_user_integralrecord`
ADD INDEX `index_hotel`(`hotel_id`);
INSERT INTO `cloud`.`savor_sys_config`(`config_key`, `config_value`, `status`) VALUES ('welcome_playtime', '0', 1);
INSERT INTO `cloud`.`savor_sys_config`(`config_key`, `config_value`, `status`) VALUES ('welcome_musicvolume', '0', 1);
ALTER TABLE `cloud`.`savor_smallapp_user_integralrecord`
DROP INDEX `index_openid`,
ADD INDEX `index_openidtask`(`openid`, `task_id`) USING BTREE;

CREATE TABLE `savor_smallapp_welcome` (
  `id` bigint(20) NOT NULL AUTO_INCREMENT,
  `user_id` bigint(20) NOT NULL DEFAULT '0' COMMENT '用户ID',
  `image` varchar(50) NOT NULL DEFAULT '' COMMENT '自主上传图片',
  `rotate` int(11) NOT NULL DEFAULT '0' COMMENT '旋转角度',
  `backgroundimg_id` int(11) NOT NULL DEFAULT '0' COMMENT '背景图ID',
  `content` varchar(100) NOT NULL DEFAULT '' COMMENT '欢迎词内容',
  `wordsize_id` int(11) NOT NULL DEFAULT '0' COMMENT '字号ID',
  `color_id` int(11) NOT NULL DEFAULT '0' COMMENT '颜色ID',
  `music_id` int(11) NOT NULL DEFAULT '0' COMMENT '音乐ID',
  `play_type` tinyint(1) NOT NULL DEFAULT '0' COMMENT '播放类型1立即播放 2定时播放',
  `status` tinyint(1) NOT NULL DEFAULT '0' COMMENT '状态0无 1正在播放 2定时播放 3已结束',
  `play_date` date DEFAULT NULL COMMENT '开始日期',
  `timing` time DEFAULT NULL COMMENT '定时精确到小时如: 13:00',
  `finish_time` datetime NOT NULL DEFAULT '0000-00-00 00:00:00' COMMENT '播放结束时间',
  `hotel_id` int(11) NOT NULL DEFAULT '0' COMMENT '酒楼id',
  `box_mac` varchar(15) NOT NULL DEFAULT '' COMMENT '机顶盒mac',
  `add_time` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '添加时间',
  PRIMARY KEY (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COMMENT='欢迎词表';

CREATE TABLE `savor_smallapp_welcome_resource` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `name` varchar(50) NOT NULL DEFAULT '' COMMENT '名称',
  `category_id` int(11) NOT NULL DEFAULT '0' COMMENT '分类ID',
  `media_id` int(11) NOT NULL DEFAULT '0' COMMENT '音乐资源ID',
  `color` varchar(50) NOT NULL DEFAULT '' COMMENT '颜色',
  `small_wordsize` int(11) NOT NULL DEFAULT '0' COMMENT '小程序字体大小',
  `tv_wordsize` int(11) NOT NULL DEFAULT '0' COMMENT '电视字体大小',
  `type` tinyint(1) NOT NULL DEFAULT '0' COMMENT '类型1字号,2颜色,3音乐',
  `status` tinyint(1) NOT NULL DEFAULT '0' COMMENT '状态0无,1启用,2禁用',
  `add_time` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '添加时间',
  PRIMARY KEY (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COMMENT='欢迎词资源';

ALTER TABLE `cloud`.`savor_smallapp_welcome`
ADD COLUMN `type` tinyint(1) NOT NULL DEFAULT 1 COMMENT '类型1单个盒子播放,2全部盒子播放' AFTER `box_mac`;

ALTER TABLE `cloud`.`savor_smallapp_welcome`
ADD COLUMN `font_id` int(11) NOT NULL DEFAULT 0 COMMENT '字体ID' AFTER `music_id`;


增加说明：增加销售端秒杀商品以及记录日志
修改时间：2019-12-04 15:00
修改人：刘斌
执行SQL
ALTER TABLE `cloud`.`savor_smallapp_goods`
MODIFY COLUMN `type` tinyint(1) NOT NULL DEFAULT 0 COMMENT '类型 10热点优选,20商家添加,30积分兑换现金,31积分兑换物品,40秒杀商品' AFTER `page_url`;
ALTER TABLE `cloud`.`savor_qrscan_record`
ADD COLUMN `box_mac` varchar(20) NOT NULL DEFAULT '' COMMENT '盒子Mac地址' AFTER `ip`;
ALTER TABLE `cloud`.`savor_urlmap`
ADD COLUMN `goods_id` int(11) NOT NULL DEFAULT 0 COMMENT '商品ID' AFTER `link`;
ALTER TABLE `cloud`.`savor_urlmap`
ADD COLUMN `short_link` varchar(255) NOT NULL DEFAULT '' COMMENT '短链' AFTER `link`;
ALTER TABLE `cloud`.`savor_qrscan_record`
ADD COLUMN `data_id` int(11) NOT NULL DEFAULT 0 COMMENT '数据id' AFTER `box_mac`;

增加说明：增加主干版本投屏轨迹
修改时间：2020-01-09 17:01:21
修改人：刘斌
执行SQL
CREATE TABLE `savor_smallapp_forscreen_track` (
  `id` bigint(20) NOT NULL AUTO_INCREMENT,
  `forscreen_record_id` bigint(20) NOT NULL DEFAULT '0' COMMENT '投屏id',
  `serial_number` char(32) NOT NULL DEFAULT '' COMMENT '唯一序列号',
  `oss_stime` bigint(20) NOT NULL DEFAULT '0' COMMENT '资源oss上传开始时间',
  `oss_etime` bigint(20) NOT NULL DEFAULT '0' COMMENT '资源oss上传结束时间',
  `position_nettystime` bigint(20) NOT NULL DEFAULT '0' COMMENT 'php请求定位netty接口开始时间',
  `position_nettyetime` bigint(20) NOT NULL DEFAULT '0' COMMENT 'php请求定位netty接口结束时间',
  `netty_position_url` varchar(255) NOT NULL DEFAULT '' COMMENT 'netty定位接口',
  `netty_position_result` varchar(255) NOT NULL DEFAULT '' COMMENT 'netty定位接口返回数据',
  `request_nettytime` bigint(20) NOT NULL DEFAULT '0' COMMENT 'PHP请求netty时间',
  `netty_url` text NOT NULL COMMENT 'php请求netty接口',
  `netty_result` varchar(255) NOT NULL DEFAULT '' COMMENT 'netty返回数据',
  `netty_receive_time` bigint(20) NOT NULL DEFAULT '0' COMMENT 'netty接收php请求时间',
  `netty_pushbox_time` bigint(20) NOT NULL DEFAULT '0' COMMENT 'netty推送盒子时间',
  `box_receivetime` bigint(20) NOT NULL DEFAULT '0' COMMENT '盒子接收netty时间',
  `box_downstime` bigint(20) NOT NULL DEFAULT '0' COMMENT '盒子下载开始时间',
  `box_downetime` bigint(20) NOT NULL DEFAULT '0' COMMENT '盒子下载完成时间',
  `add_time` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '添加时间',
  PRIMARY KEY (`id`),
  KEY `key_frecordid` (`forscreen_record_id`),
  KEY `key_serialno` (`serial_number`)
) ENGINE=MyISAM DEFAULT CHARSET=utf8 COMMENT='投屏轨迹表';


增加说明：增加销售端分润
修改时间：2020-01-19 10:50:35
修改人：刘斌
执行SQL
ALTER TABLE `cloud`.`savor_integral_task`
ADD COLUMN `is_shareprofit` tinyint(1) NOT NULL DEFAULT 0 COMMENT '是否支持分润' AFTER `is_long_time`;

ALTER TABLE `cloud`.`savor_smallapp_goods`
ADD COLUMN `duration` tinyint(11) NOT NULL DEFAULT 0 COMMENT '播放时长' AFTER `scope`;

ALTER TABLE `cloud`.`savor_smallapp_user_integralrecord`
MODIFY COLUMN `source` tinyint(1) NOT NULL DEFAULT 1 COMMENT '来源 1正常订单order,2京东订单,3兑换,4分润' AFTER `type`;

CREATE TABLE `savor_integral_task_shareprofit` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `task_id` int(11) NOT NULL DEFAULT '0' COMMENT '任务id',
  `hotel_id` int(11) NOT NULL DEFAULT '0' COMMENT '酒楼id',
  `openid` varchar(100) NOT NULL DEFAULT '' COMMENT 'openid',
  `level1` int(11) NOT NULL DEFAULT '0' COMMENT '等级1分润(管理员)',
  `level2` int(11) NOT NULL DEFAULT '0' COMMENT '等级2分润(员工)',
  `add_time` timestamp NULL DEFAULT CURRENT_TIMESTAMP COMMENT '添加时间',
  PRIMARY KEY (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COMMENT='任务分润';

CREATE TABLE `savor_integral_shareprofitrecord` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `integralrecord_id` int(11) NOT NULL DEFAULT '0' COMMENT '用户积分记录表主键ID',
  `original_integral` int(11) NOT NULL DEFAULT '0' COMMENT '原始积分',
  `openid` varchar(100) NOT NULL DEFAULT '' COMMENT '获得分润用户openid',
  `shareprofit_integral` int(11) NOT NULL DEFAULT '0' COMMENT '分润积分',
  `shareprofit_config` varchar(100) NOT NULL DEFAULT '' COMMENT '当前分润设置',
  `add_time` datetime DEFAULT CURRENT_TIMESTAMP COMMENT '添加时间',
  PRIMARY KEY (`id`),
  KEY `index_irecordid` (`integralrecord_id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COMMENT='用户分润积分记录表';